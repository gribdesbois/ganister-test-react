function _0x32d2(){const _0x288ae9=['\x20{\x20_id:\x20$_id\x20})\x0a\x20\x20\x20\x20\x20\x20OPTIONAL\x20MATCH\x20(n)-[r:','forEach','defineProperties','join','210090lyAuTH','assign','../helpers','3289995SUTYEV','3736RjKrCO','8597EfHXig','push','splice','118vkFojg','_versionNumber','_lockState','exports','3kbqGXK','now','json','find','versionnable','6lpndgf','./errors','values','_id','versions','PermissionSet','properties','string','Group','2946668ALhVRO','map','<br>\x20-\x20','accessRole','3610590cxzuev','../queries/node','runQuery','_history','datamodel','\x0a\x20\x20\x20\x20\x20\x20MATCH\x20(n:','get','<br>-\x20','lifecycle','_version','length','clone','type','_state','name','The\x20following\x20properties\x20are\x20required\x20to\x20promote\x20node:\x20%s','generated','_promotions','11095xrXlye','6940571eYurgU'];_0x32d2=function(){return _0x288ae9;};return _0x32d2();}function _0x1191(_0x2468ba,_0x402b90){const _0x32d2d0=_0x32d2();return _0x1191=function(_0x1191ff,_0x5557ad){_0x1191ff=_0x1191ff-0xd0;let _0x552681=_0x32d2d0[_0x1191ff];return _0x552681;},_0x1191(_0x2468ba,_0x402b90);}const _0x2bbc66=_0x1191;(function(_0x1a9257,_0x5d7cdc){const _0x3316a5=_0x1191,_0x19d689=_0x1a9257();while(!![]){try{const _0x58b0af=parseInt(_0x3316a5(0xef))/0x1*(parseInt(_0x3316a5(0xf2))/0x2)+-parseInt(_0x3316a5(0xf6))/0x3*(parseInt(_0x3316a5(0x104))/0x4)+-parseInt(_0x3316a5(0xea))/0x5*(parseInt(_0x3316a5(0xfb))/0x6)+-parseInt(_0x3316a5(0xe4))/0x7*(-parseInt(_0x3316a5(0xee))/0x8)+-parseInt(_0x3316a5(0xed))/0x9+-parseInt(_0x3316a5(0xd2))/0xa+parseInt(_0x3316a5(0xe5))/0xb;if(_0x58b0af===_0x5d7cdc)break;else _0x19d689['push'](_0x19d689['shift']());}catch(_0x50423c){_0x19d689['push'](_0x19d689['shift']());}}}(_0x32d2,0x5b158));const Database=require('../modules/database'),nodeQueries=require(_0x2bbc66(0xd3)),{validateSchema}=require('./schemaUtil'),{removeUnwantedProperties,convertPropertiesWithObjects,checkUniqueProperties,addCodification,addPseudoProperties}=require('./nodetype'),{lastOf,versionNumber,nullifyEmptyStrings,getNodetype}=require(_0x2bbc66(0xec)),{ganisterError}=require(_0x2bbc66(0xfc)),updateHistory=async _0x1652f8=>{const _0x898ef6=_0x2bbc66,_0x19cbf8=_0x1652f8['datamodel'];if(!_0x19cbf8||!_0x1652f8[_0x898ef6(0xfe)])return;const {query:_0x2ba3f3,params:_0x5b20d2}=nodeQueries[_0x898ef6(0xd8)](_0x1652f8),[_0x221f74]=await Database[_0x898ef6(0xd4)](_0x2ba3f3,_0x5b20d2),_0xc9e5b4=_0x221f74?.[_0x898ef6(0xd8)]('n');if(!_0xc9e5b4)return;const _0x139f9e={..._0x1652f8,'properties':_0xc9e5b4[_0x898ef6(0x101)]},_0x37b062=_0x139f9e[_0x898ef6(0x101)][_0x898ef6(0xd5)]||[],_0x5f0f79=lastOf(_0x37b062)||{},{_id:_0x1a069f,_labelRef:_0x20fe93}=_0x1652f8['user']?.[_0x898ef6(0x101)]||{},_0x7c718=Date['now'](),_0x3d1af2={'_modifiedOn':_0x7c718,'user':{'_id':_0x1a069f,'_labelRef':_0x20fe93},'properties':{}};_0x19cbf8['properties'][_0x898ef6(0xe7)](_0x5df0f5=>{const _0x4cfc8b=_0x898ef6,{type:_0x7796e2,name:_0x39f4bb}=_0x5df0f5;if(_0x39f4bb===_0x4cfc8b(0xf4))return;const _0xc57d2f=[_0x4cfc8b(0xf8),'node'],_0x2284fa=_0xc57d2f['includes'](_0x7796e2);if(_0x2284fa||_0x5df0f5[_0x4cfc8b(0xe2)])return;const _0x25e500=_0x139f9e[_0x4cfc8b(0x101)][_0x39f4bb],_0x4aec50=_0x1652f8[_0x4cfc8b(0x101)][_0x39f4bb];_0x25e500!==_0x4aec50&&(_0x3d1af2['properties'][_0x39f4bb]=_0x25e500);});const _0x50ab6e=Object[_0x898ef6(0xfd)](_0x3d1af2[_0x898ef6(0x101)])[_0x898ef6(0xdc)];if(_0x50ab6e){const _0x2b50f8=_0x7c718-_0x139f9e[_0x898ef6(0x101)]['_modifiedOn'];_0x2b50f8>0x36ee80?_0x37b062[_0x898ef6(0xf0)](_0x3d1af2):(_0x3d1af2[_0x898ef6(0x101)]={..._0x5f0f79[_0x898ef6(0x101)],..._0x3d1af2['properties']},Object[_0x898ef6(0xeb)](_0x5f0f79,_0x3d1af2),_0x37b062[_0x898ef6(0xf1)](-0x1,0x1,_0x5f0f79));}return _0x1652f8[_0x898ef6(0x101)][_0x898ef6(0xd5)]=_0x37b062,_0x1652f8;};module[_0x2bbc66(0xf5)]={'buildAndValidate':async _0x2157c7=>{const _0x16ff10=_0x2bbc66;return nullifyEmptyStrings(_0x2157c7),removeUnwantedProperties(_0x2157c7),_0x2157c7[_0x16ff10(0x101)]['_modifiedOn']=_0x2157c7[_0x16ff10(0xfe)]?undefined:null,await updateHistory(_0x2157c7),convertPropertiesWithObjects(_0x2157c7),validateSchema(_0x2157c7),!_0x2157c7[_0x16ff10(0xdd)]&&(await checkUniqueProperties(_0x2157c7),await addCodification(_0x2157c7)),addPseudoProperties(_0x2157c7),_0x2157c7;},'setAccessRelationshipData':_0x1dc063=>{const _0x1b2eea=_0x2bbc66,{_type:_0xe7720,user:_0x49bf49}=_0x1dc063,_0x5c68a7=_0x1dc063['_type']===_0x1b2eea(0x100),_0x30514e={'_type':_0x5c68a7?_0x1b2eea(0x103):_0x1b2eea(0x100),'_id':_0x1b2eea(0x102),'properties':{'name':_0x5c68a7?'Administrator':_0xe7720},'user':_0x49bf49},_0x1c1e47={'_type':_0x1b2eea(0xd1),'properties':{'role':_0x5c68a7?'manager':'permissionSet'},'source':_0x30514e,'target':_0x1dc063,'user':_0x49bf49};return _0x1c1e47;},'hideDetails':_0x328da0=>{const _0x428e45=_0x2bbc66;if(!_0x328da0[_0x428e45(0x101)])return _0x328da0;return Object[_0x428e45(0xe8)](_0x328da0[_0x428e45(0x101)],{'_promotions':{'enumerable':![]},'_history':{'enumerable':![]}}),_0x328da0;},'setVersions':_0x1aadfa=>{const _0x2b691c=_0x2bbc66,{versions:_0x2ff8ea}=_0x1aadfa[_0x2b691c(0x101)];if(!_0x2ff8ea)return;const _0x2f4db9=_0x1aadfa[_0x2b691c(0xd6)]?.[_0x2b691c(0xfa)];if(!_0x2f4db9)return;const {_id:_0x1cf43b,_version:_0x2d44cd}=_0x1aadfa[_0x2b691c(0x101)];return _0x2ff8ea[_0x2b691c(0xf0)]({'_id':_0x1cf43b,'_version':_0x2d44cd}),_0x2ff8ea[_0x2b691c(0x105)](_0xd3b34e=>{const _0x599ab6=_0x2b691c,_0x352c14=_0xd3b34e[_0x599ab6(0xdb)];return _0xd3b34e[_0x599ab6(0xf3)]=versionNumber(_0x352c14),_0xd3b34e;})['sort']((_0x2cc6bc,_0x2da659)=>_0x2cc6bc[_0x2b691c(0xf3)]-_0x2da659[_0x2b691c(0xf3)])[_0x2b691c(0xe7)](_0x41220e=>delete _0x41220e[_0x2b691c(0xf3)]),_0x1aadfa[_0x2b691c(0xff)]=_0x2ff8ea,delete _0x1aadfa[_0x2b691c(0x101)][_0x2b691c(0xff)],_0x1aadfa;},'updatePromotions':(_0x53867e,_0x4a7ccf,_0x36b44a,_0x507bc1)=>{const _0x263106=_0x2bbc66,{_promotions:_promotions=[],_state:_0x5f525b,_version:_0x9ef495}=_0x53867e[_0x263106(0x101)],{_id:_0x588047,name:_0x55a21f}=_0x4a7ccf[_0x263106(0x101)],_0x452d8e={'fromState':_0x5f525b,'toState':_0x36b44a,'user':{'name':_0x55a21f,'_id':_0x588047},'comment':_0x507bc1,'time':Date[_0x263106(0xf7)](),'_version':_0x9ef495};return _promotions[_0x263106(0xf0)](_0x452d8e),_0x53867e[_0x263106(0x101)][_0x263106(0xe3)]=_promotions,_0x53867e['promotion']=!![],_0x53867e;},'applyReleasedPromotion':async _0x4d0681=>{const _0x526194=_0x2bbc66,{_releasedOn:_0x42c884}=_0x4d0681['properties'];if(!_0x42c884)return;const {query:_0xf2f416,params:_0x4f4a5e}=nodeQueries['applyReleasedPromotion'](_0x4d0681),[_0x4d8dbf]=await Database[_0x526194(0xd4)](_0xf2f416,_0x4f4a5e);if(!_0x4d8dbf)return;return!![];},'checkMandatoryProperties':_0x34a53d=>{const _0x1b5411=_0x2bbc66,{states:states=[]}=_0x34a53d['datamodel'][_0x1b5411(0xda)],_0x3671d6=states[_0x1b5411(0xf9)](_0x4bd544=>_0x4bd544['name']===_0x34a53d[_0x1b5411(0x101)][_0x1b5411(0xdf)]),{mandatoryProperties:mandatoryProperties=[]}=_0x3671d6,_0x473bd3=mandatoryProperties[_0x1b5411(0x105)](_0x4a04aa=>{const _0x7f479b=_0x1b5411,_0x2d2845=_0x34a53d[_0x7f479b(0x101)][_0x4a04aa];if(_0x2d2845==null)return _0x7f479b(0xd9)+_0x4a04aa;return'';})['join']('');if(_0x473bd3)throw ganisterError(__(_0x1b5411(0xe1),_0x473bd3));},'checkMandatoryRelationships':async _0x2d6784=>{const _0x45d80f=_0x2bbc66,{states:states=[]}=_0x2d6784[_0x45d80f(0xd6)][_0x45d80f(0xda)],_0x11914a=states[_0x45d80f(0xf9)](_0x59b54d=>_0x59b54d[_0x45d80f(0xe0)]===_0x2d6784[_0x45d80f(0x101)][_0x45d80f(0xdf)]),{mandatoryRels:mandatoryRels=[]}=_0x11914a,_0x1a0186=mandatoryRels['map'](_0x50fbe3=>{const _0x594343=getNodetype(_0x50fbe3);return _0x594343['linkName'];});if(!_0x1a0186['length'])return;const _0x4499eb=_0x45d80f(0xd7)+_0x2d6784['_type']+_0x45d80f(0xe6)+_0x1a0186['join']('|')+']-()\x0a\x20\x20\x20\x20\x20\x20RETURN\x20r\x0a\x20\x20\x20\x20',_0x35ea39={'_id':_0x2d6784[_0x45d80f(0xfe)]},_0x2d682b=await Database[_0x45d80f(0xd4)](_0x4499eb,_0x35ea39),_0x81fc00=mandatoryRels['map'](_0x2af0f3=>{const _0x46ac6b=_0x45d80f,_0x250d4d=getNodetype(_0x2af0f3),_0x3e19a8=_0x2d682b[_0x46ac6b(0xf9)](_0x273548=>{const _0xeb36ef=_0x46ac6b,_0x506e18=_0x273548?.[_0xeb36ef(0xd8)]('r');return _0x506e18?.[_0xeb36ef(0xde)]===_0x250d4d['linkName'];});if(!_0x3e19a8)return _0x46ac6b(0xd0)+_0x2af0f3;return'';})[_0x45d80f(0xe9)]('');if(_0x81fc00)throw ganisterError(__('The\x20following\x20relationships\x20are\x20required\x20to\x20promote\x20node:\x20%s',_0x81fc00));}};