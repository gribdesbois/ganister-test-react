function _0x511e(){const _0x2d9c96=['subscribeTo','errors','push','37352NygQEQ','accessRole','../models/datamodelSchema.json','length','exports','default','directions','filter','find','1WNImlT','node','revision','eco','224338KKsTUR','transitions','file','elementType','478125Stsmhe','section','includes','lifecycleRole','1928060FENQHC','1044978ePbGqv','7731vIUElN','user','splice','221748ctdhzW','utf8','stringify','error','readFileSync','writeFileSync','.json','findIndex','4sQudHB','compile','handlesChangeOf','Group','ajv','./build/datamodel.json','../middlewares/datamodelMethods','name','forEach','PermissionSet','nodetypeDefinitions','2584qKwZqx'];_0x511e=function(){return _0x2d9c96;};return _0x511e();}function _0x3b9a(_0x1f77dc,_0x1b51fc){const _0x511e45=_0x511e();return _0x3b9a=function(_0x3b9adf,_0x131372){_0x3b9adf=_0x3b9adf-0xf1;let _0x4ac0ea=_0x511e45[_0x3b9adf];return _0x4ac0ea;},_0x3b9a(_0x1f77dc,_0x1b51fc);}const _0x144daf=_0x3b9a;(function(_0x4cae24,_0x34733a){const _0x2676b6=_0x3b9a,_0x3225a7=_0x4cae24();while(!![]){try{const _0x171a2e=-parseInt(_0x2676b6(0x10d))/0x1*(parseInt(_0x2676b6(0x111))/0x2)+-parseInt(_0x2676b6(0x11e))/0x3*(-parseInt(_0x2676b6(0xf5))/0x4)+parseInt(_0x2676b6(0x115))/0x5+parseInt(_0x2676b6(0x11a))/0x6+-parseInt(_0x2676b6(0x104))/0x7+parseInt(_0x2676b6(0x100))/0x8*(-parseInt(_0x2676b6(0x11b))/0x9)+parseInt(_0x2676b6(0x119))/0xa;if(_0x171a2e===_0x34733a)break;else _0x3225a7['push'](_0x3225a7['shift']());}catch(_0x177973){_0x3225a7['push'](_0x3225a7['shift']());}}}(_0x511e,0x228ec));const fs=require('fs'),Ajv=require(_0x144daf(0xf9))[_0x144daf(0x109)],jsonSchema=require(_0x144daf(0x106)),{splitDatamodel}=require(_0x144daf(0xfb)),datamodelFile=_0x144daf(0xfa),ajv=new Ajv({'allErrors':!![],'allowUnionTypes':!![]});module[_0x144daf(0x108)]={'write':async(_0x4c569f,_0x526784,_0x5dcdc4,_0x55dd79)=>{const _0x7efe5e=_0x144daf;try{const _0x199655=_0x4c569f,_0x4dd92f=ajv[_0x7efe5e(0xf6)](jsonSchema),_0x5268ae=_0x4dd92f(_0x199655);if(!_0x5268ae)return _0x5dcdc4(_0x4dd92f[_0x7efe5e(0x102)]),![];_0x55dd79?.[_0x7efe5e(0x116)]===_0x7efe5e(0xff)&&_0x55dd79?.['name']&&updateRelationshipsNodetypes(_0x199655,_0x55dd79[_0x7efe5e(0xfc)]),fs[_0x7efe5e(0xf2)](datamodelFile,JSON[_0x7efe5e(0x120)](_0x199655,null,'\x09'),{'encoding':_0x7efe5e(0x11f)}),global['datamodel']=_0x199655,splitDatamodel(_0x55dd79);}catch(_0x59d9ed){return console[_0x7efe5e(0x121)](_0x59d9ed),![];}return _0x526784(_0x4c569f),!![];}};const updateRelationshipsNodetypes=(_0x30a84b,_0x2983b4)=>{const _0x3fd12c=_0x144daf,{nodetypeDefinitions:_0x2b161e}=_0x30a84b,_0x58581a=_0x2b161e[_0x3fd12c(0x10c)](_0x1a072b=>_0x1a072b[_0x3fd12c(0xfc)]===_0x2983b4);_0x2b161e[_0x3fd12c(0xfd)](_0x302ba3=>{const _0x4b53e2=_0x3fd12c;if(_0x302ba3[_0x4b53e2(0x114)]==='node')return;let _0x4bf5a9;switch(_0x302ba3[_0x4b53e2(0xfc)]){case _0x4b53e2(0x105):{_0x58581a['elementType']===_0x4b53e2(0x10e)&&_0x2b161e[_0x4b53e2(0x10b)](_0x442af5=>[_0x4b53e2(0xfe),_0x4b53e2(0xf8),_0x4b53e2(0x11c)][_0x4b53e2(0x117)](_0x442af5['name']))[_0x4b53e2(0xfd)](_0x35e97d=>{const _0x370588=_0x4b53e2;let _0x3e999c=_0x302ba3['directions']['find'](({source:_0x766509,target:_0x582d81})=>{return _0x766509===_0x35e97d['id']&&_0x582d81===_0x58581a['id'];});!_0x3e999c&&(_0x3e999c={'source':_0x35e97d['id'],'target':_0x58581a['id']},_0x302ba3[_0x370588(0x10a)][_0x370588(0x103)](_0x3e999c),_0x4bf5a9=!![]);});break;}case _0x4b53e2(0x118):{const {elementType:_0x1f30d8,name:_0xf4a124,lifecycle:lifecycle={}}=_0x58581a,_0x41e27b=_0x1f30d8===_0x4b53e2(0x10e),_0x21e8f6=_0xf4a124==='user',_0x17ce0d=lifecycle[_0x4b53e2(0x112)]?.[_0x4b53e2(0x107)],_0x109807=_0x41e27b&&!_0x21e8f6&&_0x17ce0d;_0x2b161e[_0x4b53e2(0x10b)](_0x508b58=>[_0x4b53e2(0xf8),_0x4b53e2(0x11c)][_0x4b53e2(0x117)](_0x508b58['name']))[_0x4b53e2(0xfd)](_0x58221c=>{const _0x59f57e=_0x4b53e2,_0x41b77a=_0x302ba3['directions'][_0x59f57e(0xf4)](({source:_0x3c620c,target:_0x28802a})=>{return _0x3c620c===_0x58581a['id']&&_0x28802a===_0x58221c['id'];});if(_0x41b77a<0x0&&_0x109807){const _0xe84525={'source':_0x58581a['id'],'target':_0x58221c['id']};_0x302ba3['directions'][_0x59f57e(0x103)](_0xe84525),_0x4bf5a9=!![];}else _0x41b77a>=0x0&&!_0x109807&&(_0x302ba3['directions'][_0x59f57e(0x11d)](_0x41b77a,0x1),_0x4bf5a9=!![]);});break;}case'generated':case _0x4b53e2(0xf7):{const {changeMethod:_0x9614a7}=_0x58581a,_0x25ca96=_0x2b161e[_0x4b53e2(0x10c)](_0xe03a8f=>_0xe03a8f[_0x4b53e2(0xfc)]===_0x4b53e2(0x110)),_0x380f9f=_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0xf4)](({source:_0x49f9c4,target:_0x24b3f9})=>{return _0x49f9c4===_0x25ca96['id']&&_0x24b3f9===_0x58581a['id'];});if(_0x380f9f<0x0&&_0x9614a7===_0x4b53e2(0x110)){const _0x5290df={'source':_0x25ca96['id'],'target':_0x58581a['id']};_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0x103)](_0x5290df),_0x4bf5a9=!![];}else _0x380f9f>=0x0&&_0x9614a7!==_0x4b53e2(0x110)&&(_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0x11d)](_0x380f9f,0x1),_0x4bf5a9=!![]);break;}case'fork':case _0x4b53e2(0x10f):{const {versionnable:_0xb46e5d}=_0x58581a,_0x2661e5=_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0xf4)](({source:_0x439322,target:_0x314ac8})=>{return _0x439322===_0x58581a['id']&&_0x314ac8===_0x58581a['id'];});if(_0x2661e5<0x0&&_0xb46e5d){const _0x180298={'source':_0x58581a['id'],'target':_0x58581a['id']};_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0x103)](_0x180298),_0x4bf5a9=!![];}else _0x2661e5>=0x0&&!_0xb46e5d&&(_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0x11d)](_0x2661e5,0x1),_0x4bf5a9=!![]);break;}case'nodeThumbnail':{const {hasThumbnail:_0x3c08e7}=_0x58581a,_0x291799=_0x2b161e[_0x4b53e2(0x10c)](_0x295322=>_0x295322[_0x4b53e2(0xfc)]===_0x4b53e2(0x113)),_0x3aceeb=_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0xf4)](({source:_0x5405e2,target:_0x4b39d5})=>{return _0x5405e2===_0x58581a['id']&&_0x4b39d5===_0x291799['id'];});if(_0x3aceeb<0x0&&_0x3c08e7){const _0x48bd81={'source':_0x58581a['id'],'target':_0x291799['id']};_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0x103)](_0x48bd81),_0x4bf5a9=!![];}else _0x3aceeb>=0x0&&!_0x3c08e7&&(_0x302ba3['directions']['splice'](_0x3aceeb,0x1),_0x4bf5a9=!![]);break;}case _0x4b53e2(0x101):{const {elementType:_0x595b9a,name:_0x2b4fbb}=_0x58581a,_0x2fa5b8=_0x595b9a===_0x4b53e2(0x10e),_0x3f38f0=_0x2b4fbb===_0x4b53e2(0xfe),_0x4be898=_0x2fa5b8&&!_0x3f38f0,_0x56eb0d=_0x2b161e[_0x4b53e2(0x10c)](_0x109d49=>_0x109d49[_0x4b53e2(0xfc)]==='user'),_0x38f5ee=_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0xf4)](({source:_0x596858,target:_0x2b5583})=>{return _0x596858===_0x56eb0d['id']&&_0x2b5583===_0x58581a['id'];});if(_0x38f5ee<0x0&&_0x4be898){const _0x585286={'source':_0x56eb0d['id'],'target':_0x58581a['id']};_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0x103)](_0x585286),_0x4bf5a9=!![];}else _0x38f5ee>=0x0&&!_0x4be898&&(_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0x11d)](_0x38f5ee,0x1),_0x4bf5a9=!![]);break;}default:if(_0x302ba3[_0x4b53e2(0x10a)]){const _0x2e42ca=_0x302ba3['directions']['length'];_0x302ba3[_0x4b53e2(0x10a)]=_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0x10b)](({source:_0x4f7015,target:_0x56db26})=>{const _0xa26947=_0x4b53e2,_0x451d8e=_0x2b161e[_0xa26947(0x10c)](_0x2056de=>_0x2056de['id']===_0x4f7015),_0x331368=_0x2b161e[_0xa26947(0x10c)](_0x13c40e=>_0x13c40e['id']===_0x56db26);return _0x451d8e&&_0x331368;}),_0x302ba3[_0x4b53e2(0x10a)][_0x4b53e2(0x107)]!==_0x2e42ca&&(_0x4bf5a9=!![]);}break;}if(_0x4bf5a9){const _0x26956d='./api/models/dm/nodetypes/'+_0x302ba3[_0x4b53e2(0xfc)]+_0x4b53e2(0xf3),_0x139091=fs[_0x4b53e2(0xf1)](_0x26956d),_0x32b7c2=JSON['parse'](_0x139091);_0x32b7c2[_0x4b53e2(0x10a)]=_0x302ba3[_0x4b53e2(0x10a)];const _0x5a1b99=JSON[_0x4b53e2(0x120)](_0x32b7c2,null,'\x09');fs[_0x4b53e2(0xf2)](_0x26956d,_0x5a1b99);}});};