const _0x57d614=_0x20b8;(function(_0x14bc5d,_0x564f3c){const _0x44c127=_0x20b8,_0x5ad082=_0x14bc5d();while(!![]){try{const _0x13e128=parseInt(_0x44c127(0x121))/0x1+parseInt(_0x44c127(0x133))/0x2*(parseInt(_0x44c127(0x13f))/0x3)+-parseInt(_0x44c127(0x12a))/0x4+parseInt(_0x44c127(0x124))/0x5+-parseInt(_0x44c127(0x12b))/0x6*(parseInt(_0x44c127(0x122))/0x7)+parseInt(_0x44c127(0x14e))/0x8*(parseInt(_0x44c127(0x136))/0x9)+-parseInt(_0x44c127(0x140))/0xa;if(_0x13e128===_0x564f3c)break;else _0x5ad082['push'](_0x5ad082['shift']());}catch(_0x4c23d3){_0x5ad082['push'](_0x5ad082['shift']());}}}(_0x56ea,0x3bb5b));const Database=require('../modules/database'),Node=require(_0x57d614(0x141)),Relationship=require(_0x57d614(0x12d)),{ganisterError}=require(_0x57d614(0x12c)),globalQueries=require(_0x57d614(0x13c));function _0x20b8(_0x1a3a73,_0x32fcb5){const _0x56ea5d=_0x56ea();return _0x20b8=function(_0x20b8f8,_0x351870){_0x20b8f8=_0x20b8f8-0x120;let _0x1581f7=_0x56ea5d[_0x20b8f8];return _0x1581f7;},_0x20b8(_0x1a3a73,_0x32fcb5);}module[_0x57d614(0x12e)]={'getRequiredRoles':_0x200458=>{const _0x3b6c45=_0x57d614,{method:_0x1af3dd}=_0x200458,{nodeId:_0x4d2cb6,relationshipName:_0x2a4969,relationshipId:_0x5bbbf5}=_0x200458['params'];let _0x28876b=['manager'];switch(_0x1af3dd){case _0x3b6c45(0x149):_0x28876b=[_0x3b6c45(0x142),_0x3b6c45(0x146),_0x3b6c45(0x143)];!_0x4d2cb6&&(_0x28876b=[_0x3b6c45(0x138),'reader',_0x3b6c45(0x146),'manager']);break;case _0x3b6c45(0x13e):case _0x3b6c45(0x128):case _0x3b6c45(0x125):const _0x28d88a=['accessRole','lifecycleRole'][_0x3b6c45(0x13b)](_0x2a4969);if(!_0x28d88a)_0x28876b=['writer',_0x3b6c45(0x143)];break;case'DELETE':if(_0x5bbbf5)_0x28876b=[_0x3b6c45(0x146),_0x3b6c45(0x143)];break;default:break;}return _0x28876b;},'addPermissionSetAccess':async(_0xea1bf1,_0x46b56d)=>{const _0x462944=_0x57d614,{query:_0x328937,params:_0x4e1a16}=globalQueries[_0x462944(0x132)](_0xea1bf1,_0x46b56d),[_0x51c2dd]=await Database['runQuery'](_0x328937,_0x4e1a16),_0x4d1c7a=_0x51c2dd?.['get']('r');if(!_0x4d1c7a)throw ganisterError('ðŸš«\x20You\x20don\x27t\x20have\x20access\x20to\x20\x27'+_0xea1bf1+_0x462944(0x137),0x193);const {role:role=_0x462944(0x14b),canCreate:canCreate=![]}=_0x4d1c7a[_0x462944(0x126)];_0x46b56d[_0x462944(0x13d)]=!![],_0x46b56d[_0x462944(0x139)]=role,_0x46b56d[_0x462944(0x13a)]=canCreate;},'addAccesses':async(_0x3fbe1e,_0x41f6b9,_0x5adc55)=>{const _0x227be=_0x57d614,{query:_0x31327d,params:_0x5bfa90}=globalQueries[_0x227be(0x145)](_0x3fbe1e,_0x41f6b9),_0x4b1505=await Database['runQuery'](_0x31327d,_0x5bfa90);if(!_0x4b1505['length']){const _0x3adbc4=_0x3fbe1e[_0x227be(0x14c)]?_0x227be(0x131):'\x27'+_0x3fbe1e[_0x227be(0x144)]+_0x227be(0x120);throw ganisterError(__('ðŸš«\x20You\x20do\x20not\x20have\x20access\x20to\x20%s',_0x3adbc4),0x193);}_0x41f6b9[_0x227be(0x13d)]=!![],_0x41f6b9['correctPath']=[];const _0x5a0e5b=_0x4b1505[_0x227be(0x14a)](async _0x2034bd=>{const _0x4dcf40=_0x227be,_0x29d83a=_0x2034bd[_0x4dcf40(0x147)]('r'),_0x214817=_0x2034bd[_0x4dcf40(0x147)]('n'),_0x1945d0=_0x29d83a[_0x4dcf40(0x14a)](async _0x191e8=>{const _0x30158e=_0x4dcf40,_0x1339f5=_0x214817[_0x30158e(0x127)](_0x1eae52=>_0x1eae52['identity']===_0x191e8[_0x30158e(0x148)]),_0x1b6c2a=_0x214817[_0x30158e(0x127)](_0x340a57=>_0x340a57['identity']===_0x191e8['end']);_0x191e8[_0x30158e(0x130)]=await Node[_0x30158e(0x129)](_0x1339f5),_0x191e8[_0x30158e(0x14d)]=await Node[_0x30158e(0x129)](_0x1b6c2a);const _0x34db6c=await Relationship['new'](_0x191e8),{role:_0x113039}=_0x34db6c[_0x30158e(0x126)],_0xf7d2c0=_0x5adc55[_0x30158e(0x123)](_0x113039),_0x1d91e7=_0x5adc55[_0x30158e(0x123)](_0x41f6b9[_0x30158e(0x139)]);return _0xf7d2c0>_0x1d91e7&&(_0x41f6b9[_0x30158e(0x139)]=_0x113039),_0x34db6c;}),_0x351ad2=await Promise[_0x4dcf40(0x134)](_0x1945d0);return _0x351ad2;}),_0x5dd182=await Promise['all'](_0x5a0e5b),_0xd14f1f=_0x5adc55[_0x227be(0x123)](_0x41f6b9['highestAccess']),_0x71df47=_0x5dd182['filter'](_0x4e5696=>{const _0x4e5032=_0x227be;return _0x4e5696[_0x4e5032(0x127)](_0x3c5c3f=>{const _0x459a9f=_0x4e5032,{role:_0x1b2186}=_0x3c5c3f[_0x459a9f(0x126)],_0x3609eb=_0x5adc55[_0x459a9f(0x123)](_0x1b2186);return _0x3609eb===_0xd14f1f;});})['sort']((_0x1c1737,_0x333b04)=>_0x1c1737[_0x227be(0x135)]-_0x333b04[_0x227be(0x135)]),[_0x47efe3]=_0x71df47;_0x41f6b9[_0x227be(0x12f)]=_0x47efe3;}};function _0x56ea(){const _0x55bfd0=['\x27\x20nodes.','visitor','highestAccess','canCreate','includes','../queries/global','hasAccess','PUT','139839sZnfOW','1859160xEmCfw','../classes/node','reader','manager','_type','getAccesses','writer','get','start','GET','map','none','_id','target','8392yymWoQ','\x27\x20nodes','6699fxjTeS','22183RisHYi','indexOf','622105crMANE','POST','properties','find','PATCH','new','1477048AgpQvt','150TUaJBC','./errors','../classes/relationship','exports','correctPath','source','this\x20node','getPermissionSetAccess','18iGZZqn','all','length','2817hGYUSN'];_0x56ea=function(){return _0x55bfd0;};return _0x56ea();}