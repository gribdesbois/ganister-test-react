const _0xd57ce=_0xe213;(function(_0x435252,_0x5bc369){const _0x4ad837=_0xe213,_0x4766d7=_0x435252();while(!![]){try{const _0x73cb2d=parseInt(_0x4ad837(0x172))/0x1*(-parseInt(_0x4ad837(0x17f))/0x2)+-parseInt(_0x4ad837(0x156))/0x3+parseInt(_0x4ad837(0x155))/0x4*(parseInt(_0x4ad837(0x158))/0x5)+parseInt(_0x4ad837(0x187))/0x6+parseInt(_0x4ad837(0x178))/0x7*(-parseInt(_0x4ad837(0x146))/0x8)+parseInt(_0x4ad837(0x159))/0x9*(-parseInt(_0x4ad837(0x143))/0xa)+parseInt(_0x4ad837(0x183))/0xb*(parseInt(_0x4ad837(0x147))/0xc);if(_0x73cb2d===_0x5bc369)break;else _0x4766d7['push'](_0x4766d7['shift']());}catch(_0x17d424){_0x4766d7['push'](_0x4766d7['shift']());}}}(_0x2977,0x72c43));function _0x2977(){const _0x3fac0f=['Email\x20Server\x20not\x20configured','ejs','crypto-random-string','status','285632tfqQUF','1145637ZgSSKU','numeric','50wSiIqC','8121258jpVrHL','User\x20is\x20not\x20active','Email\x20Server\x20is\x20not\x20configured','notification','url-safe','_id','Unauthorized','../utils/errors','render','email','../../config/config',',\x20<br><br>Please\x20visit\x20the\x20below\x20url\x20to\x20reset\x20your\x20password:\x20<br>\x20','run','Password\x20changed','statusCode','Db\x20server\x20cannot\x20be\x20reached','TWOFA','MATCH\x20(u:user\x20{changePasswordToken:\x20$token,\x20email:\x20$email})\x20SET\x20u.password\x20=\x20\x22','Hi\x20','session','../emails/invitationEmail','true','./views/404/','json','firstName','1jQQASc','./views/changePassword/index.ejs','name','title','user','port','84063KDPqXW','body','Unauthorized\x20User','User\x20not\x20found','sendFile','utf-8','MATCH\x20(user:user\x20{email:\x20$email})\x20SET\x20user.changePasswordToken\x20=\x20\x22','1614908VWMbHL','records','Wrong\x20Credentials','MATCH\x20(user:user\x20{changePasswordToken:\x20$changePasswordToken})\x20RETURN\x20user','10522457RrpUYX','404.html','\x22\x20REMOVE\x20u.changePasswordToken\x20RETURN\x20u','get','4002438KUklUv','Ganister:\x20One\x20time\x20login\x20code','properties','readFileSync','params','10mqrsHL','url','Check\x20your\x20email\x20to\x20reset\x20your\x20password','488RFYekl','24CQhRGh','Invitation\x20to\x20join\x20Ganister','/api/v0/users/changepassword/','\x22\x20RETURN\x20user','Invitation\x20sent','Error:\x20Invitation\x20not\x20sent','No\x20user\x20found','send','MATCH\x20(user:user\x20{email:\x20$email})\x20SET\x20user.onetimecode\x20=\x20\x22','md5'];_0x2977=function(){return _0x3fac0f;};return _0x2977();}function _0xe213(_0x11e9a6,_0x15cf3b){const _0x297736=_0x2977();return _0xe213=function(_0xe213fa,_0x47384b){_0xe213fa=_0xe213fa-0x140;let _0x5be249=_0x297736[_0xe213fa];return _0x5be249;},_0xe213(_0x11e9a6,_0x15cf3b);}const md5=require(_0xd57ce(0x150)),path=require('path'),fs=require('fs'),ejs=require(_0xd57ce(0x152)),cryptoRandomString=require(_0xd57ce(0x153)),config=require(_0xd57ce(0x163)),invitationEmail=require(_0xd57ce(0x16d)),{ganisterError}=require(_0xd57ce(0x160)),driver=config['db'];module['exports']={'testUser':(_0x55b1b8,_0x1c87cd,_0xc05e25)=>{const _0x266b31=_0xd57ce,{user:_0x419699}=_0x55b1b8;try{if(!_0x419699[_0x266b31(0x15e)])return _0x1c87cd['status'](0x191)[_0x266b31(0x14e)](_0x266b31(0x15f));return _0x1c87cd[_0x266b31(0x154)](0xc8)['json'](_0x419699);}catch(_0x4fa399){_0x4fa399[_0x266b31(0x175)]='Error\x20Testing\x20User',_0xc05e25(_0x4fa399);}},'signIn':async(_0xaa081c,_0x409fcd,_0x15c5bd)=>{const _0x31809d=_0xd57ce,{user:_0x3eb71c}=_0xaa081c;try{if(_0x3eb71c['isError'])throw ganisterError(__(_0x31809d(0x181)),0x191);if(!_0x3eb71c['properties'])throw ganisterError(__(_0x31809d(0x168)),0x1f4);if(_0x3eb71c[_0x31809d(0x140)]&&!_0x3eb71c[_0x31809d(0x140)]['active'])throw ganisterError(__(_0x31809d(0x15a)),0x191);if(_0x3eb71c['properties']['TWOFA']===!![]||_0x3eb71c['properties'][_0x31809d(0x169)]===_0x31809d(0x16e)){const {email:_0x230777}=_0x3eb71c['properties'],_0x47a0df=cryptoRandomString({'length':0x6,'type':_0x31809d(0x157)}),_0x2ea73e=_0x31809d(0x14f)+_0x47a0df+_0x31809d(0x14a),_0x5daea8=driver[_0x31809d(0x16c)](),_0xc8ee4c=await _0x5daea8[_0x31809d(0x165)](_0x2ea73e,{'email':_0x230777});if(!_0xc8ee4c['records'][0x0])return _0x409fcd['status'](0xc8)[_0x31809d(0x14e)](__('Check\x20your\x20email\x20for\x20your\x20security\x20code'));const _0x3c5f4d=await ganisterMail[_0x31809d(0x14e)]({'type':_0x31809d(0x15c),'to':_0x230777,'subject':_0x31809d(0x188),'text':_0x31809d(0x16b)+_0x3eb71c[_0x31809d(0x140)][_0x31809d(0x171)]+',<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Enter\x20this\x206\x20digit\x20code\x20on\x20the\x20sign\x20in\x20page\x20to\x20confirm\x20your\x20identity:<br>\x0a\x20\x20\x20\x20'+_0x47a0df});if(!_0x3c5f4d)throw ganisterError(__(_0x31809d(0x151)));return _0x409fcd[_0x31809d(0x154)](0xc8)[_0x31809d(0x14e)](__('Check\x20your\x20email\x20for\x20your\x20security\x20code'));}return _0x409fcd['status'](0xc8)[_0x31809d(0x170)](_0x3eb71c);}catch(_0x6b1152){_0x6b1152[_0x31809d(0x175)]=_0x6b1152[_0x31809d(0x167)]?_0x31809d(0x17a):null,_0x15c5bd(_0x6b1152);}},'signIn_2FA_2':async(_0x1a87b8,_0x16695f,_0x4c689b)=>{const _0x41dbb2=_0xd57ce,{user:_0x6a643f}=_0x1a87b8,{email:_0x291256,onetimecode:_0x3063da}=_0x1a87b8[_0x41dbb2(0x179)];try{const _0x44923a='MATCH\x20(u:user\x20{onetimecode:\x20$onetimecode,\x20email:\x20$email})\x20\x20REMOVE\x20u.onetimecode\x20RETURN\x20u',_0x4bdbb2=driver[_0x41dbb2(0x16c)](),_0x42bc1a=await _0x4bdbb2['run'](_0x44923a,{'onetimecode':_0x3063da,'email':_0x291256}),[_0x4dbb84]=_0x42bc1a['records'];if(!_0x4dbb84)throw ganisterError(__('User\x20not\x20found'),0x194);return _0x16695f[_0x41dbb2(0x154)](0xc8)[_0x41dbb2(0x170)](_0x6a643f);}catch(_0x5c5fc3){_0x4c689b(_0x5c5fc3);}},'getChangePasswordPage':async(_0x5e3bc4,_0x3a25cd,_0x51b284)=>{const _0x283a47=_0xd57ce,_0x3c128f=_0x5e3bc4[_0x283a47(0x142)]['token'];try{const _0x38909d=_0x283a47(0x182),_0x412e90=driver[_0x283a47(0x16c)](),_0x444859=await _0x412e90[_0x283a47(0x165)](_0x38909d,{'changePasswordToken':_0x3c128f});if(!_0x444859['records'][0x0])return _0x3a25cd[_0x283a47(0x154)](0x194)[_0x283a47(0x17c)](_0x283a47(0x184),{'root':path['join'](_0x283a47(0x16f))});const _0x25d165=_0x444859[_0x283a47(0x180)][0x0][_0x283a47(0x186)](_0x283a47(0x176))[_0x283a47(0x140)],_0x341d29=fs[_0x283a47(0x141)](_0x283a47(0x173),_0x283a47(0x17d)),_0x386f81=ejs[_0x283a47(0x161)](_0x341d29,{'token':_0x3c128f,'firstname':_0x25d165['firstName'],'email':_0x25d165['email']});_0x3a25cd[_0x283a47(0x154)](0xc8)['send'](_0x386f81);}catch(_0x4582e1){_0x51b284(_0x4582e1);}},'postChangePassword':async(_0x18258f,_0x9b68f8,_0x49dbb5)=>{const _0xf20337=_0xd57ce,{email:_0x4b4da5}=_0x18258f[_0xf20337(0x179)],{password:_0x468d7c}=_0x18258f['body'],{token:_0x4ab2ae}=_0x18258f['body'];try{const _0x2339c5=md5(_0x468d7c),_0x4d9c4a=_0xf20337(0x16a)+_0x2339c5+_0xf20337(0x185),_0x244eac=driver[_0xf20337(0x16c)](),_0x10852a=await _0x244eac[_0xf20337(0x165)](_0x4d9c4a,{'token':_0x4ab2ae,'email':_0x4b4da5});if(!_0x10852a[_0xf20337(0x180)][0x0])return _0x9b68f8[_0xf20337(0x154)](0x194)[_0xf20337(0x14e)](_0xf20337(0x14d));return _0x9b68f8[_0xf20337(0x154)](0xc8)['send'](_0xf20337(0x166));}catch(_0x2bcbba){_0x49dbb5(_0x2bcbba);}},'postChangePasswordRequest':async(_0x4f920e,_0x4ff6ea,_0x3c3362)=>{const _0x55d046=_0xd57ce,{email:_0xf6be39}=_0x4f920e[_0x55d046(0x179)];try{const _0x1c57c6=cryptoRandomString({'length':0x1e,'type':_0x55d046(0x15d)}),_0x131859=_0x55d046(0x17e)+_0x1c57c6+_0x55d046(0x14a),_0x233c4f=driver[_0x55d046(0x16c)](),_0x340593=await _0x233c4f[_0x55d046(0x165)](_0x131859,{'email':_0xf6be39});if(!_0x340593['records'][0x0])return _0x4ff6ea['status'](0xc8)['send'](__(_0x55d046(0x145)));const _0x5e51b5=_0x340593['records'][0x0][_0x55d046(0x186)]('user')[_0x55d046(0x140)],_0xb57d38=await ganisterMail[_0x55d046(0x14e)]({'type':_0x55d046(0x15c),'to':_0xf6be39,'subject':'Ganister:\x20Password\x20Change','text':_0x55d046(0x16b)+_0x5e51b5[_0x55d046(0x171)]+_0x55d046(0x164)+config['WEBURL']+_0x55d046(0x149)+_0x1c57c6});if(!_0xb57d38)throw new Error();return _0x4ff6ea[_0x55d046(0x154)](0xc8)[_0x55d046(0x14e)](__('Check\x20your\x20email\x20to\x20reset\x20your\x20password'));}catch(_0x4e07e8){_0x4e07e8[_0x55d046(0x175)]=_0x55d046(0x15b),_0x3c3362(_0x4e07e8);}},'invite':async(_0x2284a0,_0x19b0fe,_0xaeac8)=>{const _0x3a4e91=_0xd57ce,{user:_0x54aefd}=_0x2284a0,{email:_0x274b51}=_0x2284a0[_0x3a4e91(0x179)][_0x3a4e91(0x140)];try{const _0x49ea23=cryptoRandomString({'length':0x1e,'type':_0x3a4e91(0x15d)}),_0x3b7060=_0x3a4e91(0x17e)+_0x49ea23+_0x3a4e91(0x14a),_0x5a922d=driver[_0x3a4e91(0x16c)](),_0x53bb09=await _0x5a922d[_0x3a4e91(0x165)](_0x3b7060,{'email':_0x274b51});if(!_0x53bb09['records'][0x0])throw ganisterError(__(_0x3a4e91(0x17b)),0x194);const _0x214439=_0x53bb09[_0x3a4e91(0x180)][0x0][_0x3a4e91(0x186)](_0x3a4e91(0x176))[_0x3a4e91(0x140)],_0x3f1e37=invitationEmail[_0x3a4e91(0x179)]({'name':_0x214439[_0x3a4e91(0x171)],'senderName':''+_0x54aefd[_0x3a4e91(0x140)][_0x3a4e91(0x174)],'senderEmail':_0x54aefd[_0x3a4e91(0x140)][_0x3a4e91(0x162)],'url':config[_0x3a4e91(0x144)]+':'+config[_0x3a4e91(0x177)]+_0x3a4e91(0x149)+_0x49ea23}),_0x1efdae=await ganisterMail['send']({'type':_0x3a4e91(0x15c),'to':_0x274b51,'subject':_0x3a4e91(0x148),'text':_0x3f1e37});if(!_0x1efdae)throw ganisterError(_0x3a4e91(0x14c),0x1f6);return _0x19b0fe[_0x3a4e91(0x154)](0xc8)[_0x3a4e91(0x14e)]({'error':![],'message':_0x3a4e91(0x14b)});}catch(_0x48a213){_0xaeac8(_0x48a213);}}};