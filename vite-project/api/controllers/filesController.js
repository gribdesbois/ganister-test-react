const _0x56d905=_0x345d;(function(_0x2b0fa6,_0x349e0f){const _0x14ea22=_0x345d,_0x4ec791=_0x2b0fa6();while(!![]){try{const _0x25ad6a=parseInt(_0x14ea22(0xd5))/0x1*(parseInt(_0x14ea22(0xd9))/0x2)+parseInt(_0x14ea22(0xd4))/0x3+parseInt(_0x14ea22(0xd0))/0x4*(parseInt(_0x14ea22(0xe2))/0x5)+parseInt(_0x14ea22(0xbb))/0x6+parseInt(_0x14ea22(0xbe))/0x7+-parseInt(_0x14ea22(0xc5))/0x8+-parseInt(_0x14ea22(0xc1))/0x9;if(_0x25ad6a===_0x349e0f)break;else _0x4ec791['push'](_0x4ec791['shift']());}catch(_0x1f2f64){_0x4ec791['push'](_0x4ec791['shift']());}}}(_0x33c9,0x7c051));const path=require('path'),fs=require('fs'),AWS=require(_0x56d905(0xca)),config=require(_0x56d905(0xb3)),{customErrorCompact}=require(_0x56d905(0xdc)),driver=config['db'],{S3Vault}=config;function _0x345d(_0x1cd1c7,_0x418f79){const _0x33c92b=_0x33c9();return _0x345d=function(_0x345d14,_0x4cef2c){_0x345d14=_0x345d14-0xb1;let _0x17a757=_0x33c92b[_0x345d14];return _0x17a757;},_0x345d(_0x1cd1c7,_0x418f79);}let S3bucket;S3Vault&&(S3bucket=new AWS['S3']({'region':S3Vault[_0x56d905(0xcb)][_0x56d905(0xdb)],'signatureVersion':S3Vault['config']['signatureVersion'],'accessKeyId':S3Vault['config'][_0x56d905(0xc9)],'secretAccessKey':S3Vault[_0x56d905(0xcb)][_0x56d905(0xe5)],'Bucket':S3Vault[_0x56d905(0xcb)][_0x56d905(0xba)]}));const getFileContentFromAmazonS3=async _0x32adfa=>{const _0x1eee23=_0x56d905,_0xf006cf={'Bucket':S3Vault[_0x1eee23(0xcb)][_0x1eee23(0xba)],'Key':_0x32adfa},_0x2ff76f=await S3bucket[_0x1eee23(0xcd)](_0xf006cf,_0x1c0711=>{if(_0x1c0711)return{'error':_0x1c0711};})[_0x1eee23(0xb8)]();return{'error':![],'data':_0x2ff76f[_0x1eee23(0xc2)][_0x1eee23(0xc0)]()};},putFileContentToAmazonS3=async(_0x33d812,_0x1f026b)=>{const _0x599bf0=_0x56d905,_0x27aa6d={'Bucket':S3Vault[_0x599bf0(0xcb)][_0x599bf0(0xba)],'Key':_0x33d812,'Body':Buffer[_0x599bf0(0xb9)](_0x1f026b)},_0x5aad80=await S3bucket[_0x599bf0(0xd2)](_0x27aa6d,_0x518ef0=>{if(_0x518ef0)return{'error':_0x518ef0};})[_0x599bf0(0xb8)]();return{'error':![],'data':_0x5aad80};};module[_0x56d905(0xe0)]={'getFileContents':async(_0x59d44d,_0xfc97a3)=>{const _0x26c3e0=_0x56d905,{fileId:_0x7253f4}=_0x59d44d[_0x26c3e0(0xce)];try{const _0x4062b6=_0x26c3e0(0xb1),_0x334920=driver[_0x26c3e0(0xb2)](),_0x1da629=await _0x334920['run'](_0x4062b6,{'fileId':_0x7253f4})[_0x26c3e0(0xb5)](_0x42e59=>{const _0x347cd7=_0x26c3e0;return customErrorCompact(_0x347cd7(0xbd),_0x42e59[_0x347cd7(0xe4)],0x1f4,_0x347cd7(0xdd),!![],_0x4062b6,_0x42e59);});_0x334920[_0x26c3e0(0xd7)]();if(_0x1da629[_0x26c3e0(0xd8)])return _0xfc97a3[_0x26c3e0(0xe1)](_0x1da629['code'])[_0x26c3e0(0xe7)](_0x1da629[_0x26c3e0(0xbf)]);const _0x4a579f=_0x1da629[_0x26c3e0(0xc4)][0x0][_0x26c3e0(0xcf)](_0x26c3e0(0xb6))[_0x26c3e0(0xc3)];let _0x5a9160;switch(_0x4a579f[_0x26c3e0(0xd3)]){case _0x26c3e0(0xcc):_0x5a9160=await getFileContentFromAmazonS3(_0x4a579f[_0x26c3e0(0xc7)]);if(_0x5a9160[_0x26c3e0(0xd8)]){const _0x50e37c=customErrorCompact('Cannot\x20Read\x20Amazon\x20S3\x20File',_0x5a9160['error'][_0x26c3e0(0xe4)],0x1f4,'getFileContents',!![],![],_0x5a9160[_0x26c3e0(0xd8)]);return _0xfc97a3[_0x26c3e0(0xe1)](_0x50e37c[_0x26c3e0(0xbc)])['send'](_0x50e37c[_0x26c3e0(0xbf)]);}return _0xfc97a3['status'](0xc8)[_0x26c3e0(0xe7)](_0x5a9160[_0x26c3e0(0xbf)]);case'local':fs['readFile'](path[_0x26c3e0(0xdf)](_0x26c3e0(0xe3),_0x4a579f[_0x26c3e0(0xc7)]),{'encoding':_0x26c3e0(0xe6)},(_0x4124e7,_0x4917ab)=>{const _0x215b2c=_0x26c3e0;if(_0x4124e7){const _0x2f80d2=customErrorCompact(_0x215b2c(0xda),_0x4124e7[_0x215b2c(0xe4)],0x1f4,_0x215b2c(0xdd),!![],![],_0x4124e7);return _0xfc97a3['status'](_0x2f80d2[_0x215b2c(0xbc)])['send'](_0x2f80d2[_0x215b2c(0xbf)]);}return _0xfc97a3[_0x215b2c(0xe1)](0xc8)[_0x215b2c(0xe7)](_0x4917ab);});break;default:}}catch(_0x3e8ced){return _0xfc97a3['status'](0x1f4)[_0x26c3e0(0xe7)]({'error':!![],'message':_0x3e8ced[_0x26c3e0(0xe4)]});}},'putFileContents':async(_0x4bd6d4,_0x24e4fe)=>{const _0x56a3f9=_0x56d905,{fileId:_0x34378e}=_0x4bd6d4['params'],{data:_0x405cf7}=_0x4bd6d4[_0x56a3f9(0xc6)];try{const _0x5fc947=_0x56a3f9(0xb1),_0x28439b=driver[_0x56a3f9(0xb2)](),_0x3c3303=await _0x28439b[_0x56a3f9(0xd1)](_0x5fc947,{'fileId':_0x34378e})[_0x56a3f9(0xb5)](_0x12ede9=>{const _0x636f35=_0x56a3f9;return customErrorCompact('Cannot\x20Get\x20File',_0x12ede9[_0x636f35(0xe4)],0x1f4,'putFileContents',!![],_0x5fc947,_0x12ede9);});_0x28439b[_0x56a3f9(0xd7)]();if(_0x3c3303[_0x56a3f9(0xd8)])return _0x24e4fe['status'](_0x3c3303[_0x56a3f9(0xbc)])[_0x56a3f9(0xe7)](_0x3c3303[_0x56a3f9(0xbf)]);const _0x4f9e0a=_0x3c3303[_0x56a3f9(0xc4)][0x0][_0x56a3f9(0xcf)](_0x56a3f9(0xb6))[_0x56a3f9(0xc3)];let _0x3088d4;switch(_0x4f9e0a[_0x56a3f9(0xd3)]){case _0x56a3f9(0xcc):_0x3088d4=await putFileContentToAmazonS3(_0x4f9e0a['sourceKey'],_0x405cf7);if(_0x3088d4[_0x56a3f9(0xd8)]){const _0x8c6c1b=customErrorCompact(_0x56a3f9(0xd6),_0x3088d4[_0x56a3f9(0xd8)][_0x56a3f9(0xe4)],0x1f4,_0x56a3f9(0xde),!![],![],_0x3088d4['error']);return _0x24e4fe[_0x56a3f9(0xe1)](_0x8c6c1b[_0x56a3f9(0xbc)])[_0x56a3f9(0xe7)](_0x8c6c1b[_0x56a3f9(0xbf)]);}return _0x24e4fe['status'](0xc8)[_0x56a3f9(0xe7)]();case _0x56a3f9(0xb7):fs[_0x56a3f9(0xb4)](path['join'](_0x56a3f9(0xe3),_0x4f9e0a[_0x56a3f9(0xc7)]),_0x405cf7,{'encoding':_0x56a3f9(0xe6)},_0x34f43a=>{const _0xe0f41d=_0x56a3f9;if(_0x34f43a){const _0x11aa73=customErrorCompact(_0xe0f41d(0xc8),_0x34f43a[_0xe0f41d(0xe4)],0x1f4,'putFileContents',!![],![],_0x34f43a);return _0x24e4fe[_0xe0f41d(0xe1)](_0x11aa73[_0xe0f41d(0xbc)])['send'](_0x11aa73[_0xe0f41d(0xbf)]);}return _0x24e4fe[_0xe0f41d(0xe1)](0xc8)[_0xe0f41d(0xe7)]();});break;default:}}catch(_0x4cebab){return _0x24e4fe['status'](0x1f4)[_0x56a3f9(0xe7)]({'error':!![],'message':_0x4cebab[_0x56a3f9(0xe4)]});}}};function _0x33c9(){const _0x5762f9=['secretAccessKey','utf8','send','MATCH\x20(file:file\x20{_id:\x20$fileId})\x20RETURN\x20file','session','../../config/config','writeFile','catch','file','local','promise','from','bucket','3204420MWHoZT','code','Cannot\x20Get\x20File','1865710nlHJGG','data','toString','9985113puFEmz','Body','properties','records','6711688aQkRPD','body','sourceKey','Cannot\x20Write\x20Local\x20File','accessKeyId','aws-sdk','config','amazonS3','getObject','params','get','1680112AXPHkp','run','putObject','source','908304lKFFTS','31DNHGEs','Cannot\x20Update\x20Amazon\x20S3\x20File','close','error','60194BshLxt','Cannot\x20Read\x20Local\x20File','region','../helpers/errorsHelpers','getFileContents','putFileContents','join','exports','status','5dzvuAt','./assets/','message'];_0x33c9=function(){return _0x5762f9;};return _0x33c9();}