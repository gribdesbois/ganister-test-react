function _0x2770(_0x8de3c7,_0x3517ef){const _0x5430ed=_0x5430();return _0x2770=function(_0x2770bf,_0x4f778b){_0x2770bf=_0x2770bf-0xab;let _0x421667=_0x5430ed[_0x2770bf];return _0x421667;},_0x2770(_0x8de3c7,_0x3517ef);}const _0x2d2829=_0x2770;function _0x5430(){const _0x2f039c=['datamodel','Can\x27t\x20Get\x20Node','\x20not\x20found.\x20Not\x20allowed\x20to\x20promote\x20node.','length','Invalid\x20target\x20state','find','Can\x27t\x20','Node\x20can\x27t\x20be\x20promoted\x20from\x20\x27','body','\x20Node','Can\x27t\x20%s\x20Node','params','Delete','Nodetype\x20\x27','node','684340GleFvW','label','3670112EqiWBY','title','Actual\x20state\x20and\x20target\x20state\x20are\x20the\x20same','manager','2FOWOhu','PATCH','keys','\x27\x20to\x20\x27','Can\x27t\x20Promote\x20Node','6743gMvKWh','statusCode','properties','84xLYHDk','953501dZmyGe','all','stringify','205928QqjvcZ','270835azgnoU','Undefined\x20target\x20state\x27s\x20owner','states','from','sort','lifecycle','Update','exports','\x27\x20can\x27t\x20be\x20promoted.','data','Node\x20isn\x27t\x20lockable','method','lifecycleRole','nodeId','_id','uxConfig','GET','_type','name','280RiiqDG','Unlock','Node\x20is\x20in\x20a\x20released\x20state','14208nSHIxP','9NNTIoc','DELETE','1620309UGaqcj'];_0x5430=function(){return _0x2f039c;};return _0x5430();}(function(_0x2fdd37,_0x1c243f){const _0x690bae=_0x2770,_0x7dc996=_0x2fdd37();while(!![]){try{const _0x338a2a=parseInt(_0x690bae(0xae))/0x1*(-parseInt(_0x690bae(0xe1))/0x2)+-parseInt(_0x690bae(0xcb))/0x3+parseInt(_0x690bae(0xdd))/0x4+parseInt(_0x690bae(0xb2))/0x5*(parseInt(_0x690bae(0xad))/0x6)+parseInt(_0x690bae(0xc5))/0x7*(parseInt(_0x690bae(0xb1))/0x8)+parseInt(_0x690bae(0xc9))/0x9*(parseInt(_0x690bae(0xdb))/0xa)+-parseInt(_0x690bae(0xe6))/0xb*(parseInt(_0x690bae(0xc8))/0xc);if(_0x338a2a===_0x1c243f)break;else _0x7dc996['push'](_0x7dc996['shift']());}catch(_0x55600a){_0x7dc996['push'](_0x7dc996['shift']());}}}(_0x5430,0x87630));const DataService=require('../modules/dataService'),{ganisterError}=require('../utils/errors');module[_0x2d2829(0xb9)]={'getNode':async(_0x108f7d,_0x463ed3,_0x1d79b8)=>{const _0x28812c=_0x2d2829,{method:_0x462807,user:_0x1cadc2}=_0x108f7d,{nodetype:_0x1c0b5c,nodeId:_0x4e6860}=_0x108f7d[_0x28812c(0xd7)];try{const _0x2724a3={'_type':_0x1c0b5c,'_id':_0x4e6860,'user':_0x1cadc2},_0x48df53=JSON['stringify'](Object[_0x28812c(0xe3)](_0x108f7d[_0x28812c(0xd7)])[_0x28812c(0xb6)]()),_0x48f11a=JSON[_0x28812c(0xb0)]([_0x28812c(0xbf),'nodetype']),_0x23bae4=_0x48df53===_0x48f11a,_0x2a6500={'details':_0x23bae4,'versions':_0x462807===_0x28812c(0xc2)&&_0x23bae4},{data:_0x2306c9,errors:_0x5f160a}=await DataService['find'](_0x2724a3,_0x2a6500);_0x108f7d[_0x28812c(0xda)]=_0x2306c9,_0x108f7d['errors']=_0x5f160a,_0x1d79b8();}catch(_0x2ace8b){_0x2ace8b[_0x28812c(0xde)]=__(_0x28812c(0xcd)),_0x1d79b8(_0x2ace8b);}},'checkLockState':async(_0x4f603d,_0x11c578,_0x4f75af)=>{const _0x22e299=_0x2d2829,{user:_0x31bc90,node:_0x3b127f}=_0x4f603d,{lock:_0x3afcec}=_0x4f603d[_0x22e299(0xd4)];try{const {_isAdmin:_0x1c3e00}=_0x31bc90[_0x22e299(0xac)];if(_0x1c3e00)return _0x4f75af();const {_lockable:_0x18cb24,_lockState:_0x464760,_lockedBy:_0x3168a0}=_0x3b127f[_0x22e299(0xac)];if(_0x3afcec!==undefined&&!_0x18cb24)throw ganisterError(__(_0x22e299(0xbc)));const _0x5e173e=_0x31bc90[_0x22e299(0xc0)]===_0x3168a0;if(_0x464760&&!_0x5e173e)throw ganisterError(__('Node\x20is\x20locked\x20by\x20another\x20user'));_0x4f75af();}catch(_0xa301b1){_0xa301b1['statusCode']=0x199;let _0x58502f;_0x3afcec!==undefined?_0x58502f=_0x3afcec?'Lock':_0x22e299(0xc6):_0x58502f=_0x4f603d[_0x22e299(0xbd)]===_0x22e299(0xe2)?_0x22e299(0xb8):_0x22e299(0xd8),_0xa301b1[_0x22e299(0xde)]=__(_0x22e299(0xd6),_0x58502f),_0x4f75af(_0xa301b1);}},'checkReleasedState':async(_0x38f469,_0x23c38e,_0x1e9397)=>{const _0x532d23=_0x2d2829,{method:_0x3fc691,node:_0x35422f,user:_0x3de4e4}=_0x38f469;try{if(_0x3de4e4[_0x532d23(0xac)]['_isAdmin'])return _0x1e9397();const {_releasedOn:_0x48c750,_releasedUntil:_0x42e655}=_0x35422f[_0x532d23(0xac)];if(_0x48c750&&!_0x42e655)throw ganisterError(__(_0x532d23(0xc7)));_0x1e9397();}catch(_0x1b3945){_0x1b3945[_0x532d23(0xab)]=0x199;const _0x2c747d=_0x3fc691===_0x532d23(0xca)?'Delete':_0x532d23(0xb8);_0x1b3945[_0x532d23(0xde)]=__(_0x532d23(0xd2)+_0x2c747d+_0x532d23(0xd5)),_0x1e9397(_0x1b3945);}},'checkPromotionAvailability':async(_0x1a5410,_0x20271d,_0x1b6de6)=>{const _0x133fef=_0x2d2829,{user:_0x15568a,node:_0x16079f}=_0x1a5410,{state:_0x2d9014}=_0x1a5410[_0x133fef(0xd4)];try{const _0x125f48=_0x16079f[_0x133fef(0xcc)],_0x41d78d=_0x125f48?.['lifecycle']?.[_0x133fef(0xb4)],_0xfcd5d7=_0x125f48?.['lifecycle']?.['transitions'],_0x4ed564=!_0x41d78d||!_0x41d78d['length'],_0x1e69e4=!_0xfcd5d7||!_0xfcd5d7[_0x133fef(0xcf)];if(_0x4ed564||_0x1e69e4)throw ganisterError(_0x133fef(0xd9)+_0x16079f[_0x133fef(0xc3)]+_0x133fef(0xba));const {_state:_0x4fb024}=_0x16079f['properties'];if(_0x2d9014&&_0x2d9014===_0x4fb024)throw ganisterError(__(_0x133fef(0xdf)));const _0x1f0b59=_0x41d78d[_0x133fef(0xd1)](_0x421aeb=>_0x421aeb[_0x133fef(0xc4)]===_0x2d9014);if(!_0x1f0b59)throw ganisterError(__(_0x133fef(0xd0)));const _0x2d67a4=_0x41d78d['find'](_0x796968=>_0x796968[_0x133fef(0xc4)]===_0x4fb024),_0xf0ac0c=_0xfcd5d7['find'](_0x3f5692=>{const _0x30b434=_0x133fef;return _0x3f5692[_0x30b434(0xb5)]===_0x2d67a4['id']&&_0x3f5692['to']===_0x1f0b59['id'];});if(!_0xf0ac0c)throw ganisterError(_0x133fef(0xd3)+_0x4fb024+_0x133fef(0xe4)+_0x2d9014+'\x27.');const {owner:_0x3e870c}=_0x2d67a4;if(!_0x3e870c)throw ganisterError(_0x133fef(0xb3));const {promotionByNodeManager:_0x505955}=global[_0x133fef(0xcc)][_0x133fef(0xc1)],{highestAccess:_0x3d4633}=_0x15568a,_0x2b3b56=_0x505955&&_0x3d4633===_0x133fef(0xe0);if(_0x2b3b56)return _0x1b6de6();const {roles:_0x31ccca}=_0x125f48[_0x133fef(0xb7)],_0x1527a9=_0x31ccca['find'](_0x30c312=>_0x30c312&&_0x30c312['id']===_0x3e870c),_0x4d3faa=await DataService[_0x133fef(0xaf)](_0x133fef(0xbe),{'node':_0x16079f,'user':_0x15568a}),_0x4d01a9=_0x4d3faa[_0x133fef(0xbb)],_0x3595ad=_0x4d01a9[_0x133fef(0xd1)](_0x400d14=>{const _0x21277d=_0x133fef,_0x32643f=_0x400d14['properties']['role']===_0x1527a9[_0x21277d(0xc4)],_0x5ce1a6=_0x400d14['target'][_0x21277d(0xc0)]===_0x15568a[_0x21277d(0xc0)];return _0x32643f&&_0x5ce1a6;});if(!_0x3595ad){const _0x34663e=_0x1527a9[_0x133fef(0xdc)]+_0x133fef(0xce);throw ganisterError(_0x34663e);}_0x1b6de6();}catch(_0x3ae99a){_0x3ae99a[_0x133fef(0xab)]=0x199,_0x3ae99a[_0x133fef(0xde)]=__(_0x133fef(0xe5)),_0x1b6de6(_0x3ae99a);}}};