const _0x1622fb=_0x12c1;(function(_0x412e0d,_0x40f6a3){const _0x3a75d3=_0x12c1,_0x1ab3f6=_0x412e0d();while(!![]){try{const _0x13e307=parseInt(_0x3a75d3(0x113))/0x1+parseInt(_0x3a75d3(0x117))/0x2+-parseInt(_0x3a75d3(0xe1))/0x3+parseInt(_0x3a75d3(0x112))/0x4+-parseInt(_0x3a75d3(0xee))/0x5+-parseInt(_0x3a75d3(0xf8))/0x6+-parseInt(_0x3a75d3(0xf3))/0x7*(-parseInt(_0x3a75d3(0xf7))/0x8);if(_0x13e307===_0x40f6a3)break;else _0x1ab3f6['push'](_0x1ab3f6['shift']());}catch(_0x21ac0d){_0x1ab3f6['push'](_0x1ab3f6['shift']());}}}(_0x54aa,0x46962));function _0x12c1(_0xf0fef1,_0x4cbb5b){const _0x54aa22=_0x54aa();return _0x12c1=function(_0x12c17b,_0x238753){_0x12c17b=_0x12c17b-0xd0;let _0x126980=_0x54aa22[_0x12c17b];return _0x126980;},_0x12c1(_0xf0fef1,_0x4cbb5b);}function _0x54aa(){const _0x419f37=['\x27\x20with\x20ID\x20\x27','Relationship\x20type\x20not\x20found\x20in\x20datamodel.','547032MmfIjU','lifecycleRole','state','Group','accessRole','PATCH','splice','PermissionSet','Node','POST','includes','nodetypeDefinitions','action','2328265blrkfa','indexOf','new','PermissionSet\x20\x27','role','77QmOIRM','datamodel','find','_id','404456UgxetJ','2348502DJbYLR','query','push','Relationship','/unlock','UserMember','body','targetStateId','Relationship\x20\x27','Administrator','target','assign','name','all','nodetype','Relationship\x20\x27groupMember\x27\x20not\x20found.','../modules/dataService','properties','exports','../helpers','_type','isActedBy','PUT','actualStateId','\x27\x20not\x20found','nodeId','1380244TcNncM','89713rStZgK','relationship','title','data','675270ytKGcu','visitor','map','source','isRequestedBy','params','relationships','GroupMember','relationshipId','Can\x27t\x20Delete\x20Relationship','errors','tabId','node','relationshipName','delete','lifecycle','user','Node\x20Error'];_0x54aa=function(){return _0x419f37;};return _0x54aa();}const DataService=require(_0x1622fb(0x108)),{ganisterError}=require('../utils/errors'),{getNodetype}=require(_0x1622fb(0x10b));module[_0x1622fb(0x10a)]={'formatDeprecatedRelationshipRequest':async(_0x4ecd46,_0x22118b,_0x228f39)=>{const _0x335240=_0x1622fb,{nodetype:_0x4ceca5,nodeId:_0x18e16b,targetNodeType:_0x52b9c0,targetnodeId:_0x4c8d7a,reltypeId:_0xda320,rolename:_0x4123f3,identity:_0x31c667,relationshipName:_0x15c0c4,relationshipId:_0xee50c3}=_0x4ecd46['params'],{prop:_0x1dd7a7,value:_0x2a2f77}=_0x4ecd46[_0x335240(0xfe)],{user:_0x445ff7,method:_0x6e0e05}=_0x4ecd46;try{if(_0xda320){const _0x58b9bb=getNodetype(_0xda320);if(!_0x58b9bb)throw ganisterError(_0x335240(0xe0));_0x4ecd46[_0x335240(0xd2)]['relationshipName']=_0x58b9bb['name'];}if(_0x4ecd46[_0x335240(0xfe)][_0x335240(0xd8)]||_0x4ecd46[_0x335240(0xfe)][_0x335240(0xd5)]){const _0x2c5e77=global[_0x335240(0xf4)][_0x335240(0xec)][_0x335240(0xf5)](_0x48b524=>{const _0x208dcc=_0x335240;return _0x48b524[_0x208dcc(0x104)]===_0x4ceca5;});let _0x1cfdf3;if(_0x4ecd46['body'][_0x335240(0xd8)]){const _0xa4ef4=_0x2c5e77['ui']['tabs']['find'](_0x19bb03=>_0x19bb03['id']===_0x4ecd46['body'][_0x335240(0xd8)]);if(_0xa4ef4)_0x1cfdf3=_0xa4ef4['relationships'];}else _0xee50c3&&(_0x1cfdf3=[_0xee50c3]);if(_0x2c5e77&&_0x1cfdf3){const _0x4e56aa=_0x1cfdf3[_0x335240(0x119)](_0x5c66f2=>{const _0x4ff130=_0x335240,_0x18f890=global[_0x4ff130(0xf4)]['nodetypeDefinitions'][_0x4ff130(0xf5)](_0x1f526c=>_0x1f526c['id']===_0x5c66f2);return _0x18f890['linkName'];});_0x4ecd46[_0x335240(0xfe)][_0x335240(0xd3)]=[...new Set(_0x4e56aa)],_0x4ecd46[_0x335240(0xf9)]['reverse']='true';}}const _0x57d000={'target':{'_type':_0x52b9c0,'_id':_0x4c8d7a},'properties':{}};if(_0x15c0c4&&_0xee50c3){if(_0x1dd7a7&&_0x2a2f77)_0x57d000[_0x335240(0x109)][_0x1dd7a7]=_0x2a2f77;return _0x228f39();}_0x15c0c4===_0x335240(0xe5)&&(_0x57d000[_0x335240(0x102)][_0x335240(0x10c)]=_0x4ceca5,_0x57d000[_0x335240(0x102)][_0x335240(0xf6)]=_0x18e16b);_0x15c0c4===_0x335240(0xe2)&&(_0x57d000[_0x335240(0x102)][_0x335240(0x10c)]=_0x335240(0xdd),_0x57d000[_0x335240(0x102)]['_id']=_0x31c667);if(_0x4123f3){_0x57d000[_0x335240(0x109)][_0x335240(0xf2)]=_0x4123f3;let _0x3059b8={};_0x15c0c4===_0x335240(0xe5)?_0x4123f3===_0x335240(0xe8)?_0x3059b8={'_type':_0x4123f3,'properties':{'name':_0x4ceca5}}:_0x3059b8={'_type':_0x335240(0xe9),'_id':_0x31c667}:_0x3059b8={'_type':_0x4ceca5,'_id':_0x18e16b};_0x3059b8[_0x335240(0xdd)]=_0x445ff7;const {data:_0x42d3cc,errors:_0x44b593}=await DataService[_0x335240(0xf5)](_0x3059b8),_0x2fa23a=_0x42d3cc;_0x4ecd46[_0x335240(0xd9)]=_0x2fa23a,_0x4ecd46[_0x335240(0xd7)]=_0x44b593;if(_0x31c667&&(_0x6e0e05===_0x335240(0x10e)||_0x6e0e05==='DELETE')){const _0x2e94ed=await DataService[_0x335240(0x105)](_0x335240(0xfb),{'node':_0x2fa23a,'user':_0x445ff7,'relationships':[_0x15c0c4]}),_0x6bf91c=_0x2e94ed[_0x335240(0x116)],_0x2e7b0d=_0x6bf91c[_0x335240(0xf5)](_0x479346=>{const _0x46f214=_0x335240,{source:_0x3abc49,target:_0x48e07c}=_0x479346;if(_0x15c0c4===_0x46f214(0xe5)){const {name:_0x5a091e}=_0x3abc49['properties'],_0x6ed6f2=_0x48e07c[_0x46f214(0xf6)]===_0x18e16b,_0xec4c74=_0x3abc49['_id']===_0x31c667||_0x5a091e===_0x31c667;return _0x6ed6f2&&_0xec4c74;}return _0x3abc49[_0x46f214(0xf6)]===_0x18e16b&&_0x48e07c[_0x46f214(0xf6)]===_0x31c667;});_0x4ecd46[_0x335240(0xd2)]['relationshipId']=_0x2e7b0d['_id'];}}return Object[_0x335240(0x103)](_0x4ecd46[_0x335240(0xfe)],_0x57d000),_0x228f39();}catch(_0x77be91){_0x77be91[_0x335240(0x115)]='Relationship\x20Error',_0x228f39(_0x77be91);}},'deleteFormerLifecycleRole':async(_0xfd146e,_0x156d03,_0x39cc40)=>{const _0x47d707=_0x1622fb,{node:_0x5de913,user:_0x28c482}=_0xfd146e,{relationshipName:_0x2e2473}=_0xfd146e[_0x47d707(0xd2)],{properties:_0x4bcf5b}=_0xfd146e['body'];try{const {data:_0x18f475,errors:_0x297531}=await DataService['all'](_0x2e2473,{'node':_0x5de913,'user':_0x28c482}),_0x91fdea=_0x18f475,_0x24915b=_0x91fdea['find'](_0x5dbf97=>{const _0x26b137=_0x47d707;return _0x5dbf97[_0x26b137(0x109)][_0x26b137(0xf2)]===_0x4bcf5b['role'];});if(_0x24915b){const _0x177d23=await DataService[_0x47d707(0xdb)](_0x24915b);_0xfd146e[_0x47d707(0xd7)]=[..._0xfd146e[_0x47d707(0xd7)],..._0x177d23[_0x47d707(0xd7)]];}return _0xfd146e['errors']=[..._0xfd146e[_0x47d707(0xd7)],..._0x297531],_0x39cc40();}catch(_0x59e189){_0x59e189['title']=_0x47d707(0xd6),_0x39cc40(_0x59e189);}},'formatDeprecatedNodeRequest':(_0x8c149d,_0x5120b6,_0xcee34f)=>{const _0x2d1797=_0x1622fb,{nodetype:_0x537626,actualStateId:_0x2c5cfa,targetStateId:_0x56257f}=_0x8c149d[_0x2d1797(0xd2)],{url:_0xaabbc8,node:_0x2b861c}=_0x8c149d,{mandatoryFields:_0x2ae506,newValue:_0x4c91db,value:_0x2cf141,prop:_0x2eac99,instanciationId:_0x359183,remove:_0x5a08f0}=_0x8c149d[_0x2d1797(0xfe)];try{if(!_0x8c149d[_0x2d1797(0xfe)][_0x2d1797(0x109)])_0x8c149d['body']['properties']={};_0x4c91db&&(_0x8c149d['body'][_0x2d1797(0x109)]=_0x4c91db['properties']||_0x4c91db);_0x2eac99&&_0x2cf141&&(_0x8c149d[_0x2d1797(0xfe)][_0x2d1797(0x109)][_0x2eac99]=_0x2cf141);if(_0x359183){const {_serialized:_serialized=[]}=_0x2b861c[_0x2d1797(0x109)];if(_0x5a08f0){const _0x114562=_serialized[_0x2d1797(0xef)](_0x359183);_serialized[_0x2d1797(0xe7)](_0x114562,0x1);}else _serialized[_0x2d1797(0xfa)](_0x359183);_0x8c149d[_0x2d1797(0xfe)]['properties']={'_serialized':_serialized};}_0x2ae506&&(_0x8c149d[_0x2d1797(0xfe)][_0x2d1797(0x109)]=_0x2ae506);if(_0x2c5cfa&&_0x56257f){delete _0x8c149d[_0x2d1797(0xd2)][_0x2d1797(0x10f)],delete _0x8c149d[_0x2d1797(0xd2)][_0x2d1797(0xff)];const _0x3a1afa=global['datamodel'][_0x2d1797(0xec)][_0x2d1797(0xf5)](_0x4b5cec=>_0x4b5cec[_0x2d1797(0x104)]===_0x537626),{states:_0x275f27}=_0x3a1afa[_0x2d1797(0xdc)],_0x2dcd05=_0x275f27['find'](_0x598036=>_0x598036['id']===_0x56257f);_0x8c149d[_0x2d1797(0xfe)][_0x2d1797(0xe3)]=_0x2dcd05[_0x2d1797(0x104)];}if(_0xaabbc8[_0x2d1797(0xeb)]('/lock'))_0x8c149d[_0x2d1797(0xfe)]['lock']=!![];if(_0xaabbc8['includes'](_0x2d1797(0xfc)))_0x8c149d[_0x2d1797(0xfe)]['lock']=![];return _0xcee34f();}catch(_0x59dc4e){_0x59dc4e[_0x2d1797(0x115)]=_0x2d1797(0xde),_0xcee34f(_0x59dc4e);}},'formatDeprecatedUserRequest':(_0x4da08f,_0x4b03b2,_0x49b0c4)=>{const _0x42cd6e=_0x1622fb,_0x349853=_0x4da08f[_0x42cd6e(0xfe)];try{const _0x428418={..._0x349853};return _0x4da08f[_0x42cd6e(0xd2)]['nodetype']='user',_0x4da08f[_0x42cd6e(0xfe)]['properties']=_0x428418,_0x49b0c4();}catch(_0x1ff881){_0x1ff881['title']='Node\x20Error',_0x49b0c4(_0x1ff881);}},'formatDeprecatedGroupRequest':async(_0x39d1e2,_0x1dd2a8,_0x22bb98)=>{const _0x381a39=_0x1622fb,{method:_0x334ecb,path:_0x4696a8,user:_0x210b55}=_0x39d1e2,{groupName:_0x5ed631,groupId:_0x5a8680,memberId:_0x425eb1}=_0x39d1e2[_0x381a39(0xd2)],{group:_0x44fc3b,groupType:_0x14ee77,properties:properties={}}=_0x39d1e2['body'];try{_0x39d1e2['params'][_0x381a39(0x106)]='Group',_0x39d1e2['body'][_0x381a39(0x109)]={'name':_0x44fc3b,'groupType':_0x14ee77,...properties};if(_0x5ed631||_0x5a8680){const {data:_0x251c0d}=await DataService[_0x381a39(0x105)]('Group',{'user':_0x210b55}),_0x427175=_0x251c0d,_0x514671=_0x427175[_0x381a39(0xf5)](_0x4a9cd1=>{const _0x5dcb59=_0x381a39,{_id:_0x1947ff,name:_0x1c445e}=_0x4a9cd1[_0x5dcb59(0x109)],_0x305e4b=_0x1947ff===_0x5a8680,_0x4fb5f9=_0x1c445e===_0x5ed631||_0x1c445e===_0x5a8680;return _0x305e4b||_0x4fb5f9;});if(_0x514671)_0x39d1e2[_0x381a39(0xd2)]['nodeId']=_0x514671[_0x381a39(0xf6)];}if(_0x425eb1){const _0x137350=_0x4696a8[_0x381a39(0xeb)](_0x381a39(0xfd));if(_0x137350)_0x39d1e2['params']['nodetype']=_0x381a39(0xdd);_0x39d1e2[_0x381a39(0xd2)]['nodeId']=_0x425eb1,_0x39d1e2[_0x381a39(0xd2)][_0x381a39(0xda)]='groupMember';const _0x173d1b=await DataService[_0x381a39(0xf0)]({'_type':_0x39d1e2['params'][_0x381a39(0x106)],'_id':_0x425eb1}),{data:_0x1a34b6}=await DataService[_0x381a39(0x105)]('groupMember',{'node':_0x173d1b,'user':_0x210b55}),_0x387e6e=_0x1a34b6,_0x41b8c6=_0x387e6e[_0x381a39(0xf5)](_0x34ff3a=>{const {source:_0x47dcff,target:_0x41744a}=_0x34ff3a,_0x4cda82=_0x47dcff['_id']===_0x425eb1,_0xdf11d6=_0x41744a['_id']===_0x5a8680;return _0x4cda82&&_0xdf11d6;});if(_0x334ecb!==_0x381a39(0xea)){if(!_0x41b8c6)throw ganisterError(_0x381a39(0x107),0x194);_0x41b8c6[_0x381a39(0xdd)](_0x210b55),_0x39d1e2[_0x381a39(0xd2)][_0x381a39(0xd5)]=_0x41b8c6[_0x381a39(0xf6)],_0x39d1e2[_0x381a39(0x114)]=_0x41b8c6;}else{if(_0x41b8c6)throw ganisterError(_0x381a39(0x100)+_0x41b8c6[_0x381a39(0x10c)]+'\x27\x20already\x20exists.',0x199);}_0x39d1e2[_0x381a39(0xfe)][_0x381a39(0x102)]={'_type':_0x381a39(0xe4),'_id':_0x5a8680};}return _0x22bb98();}catch(_0x3fffe1){_0x3fffe1[_0x381a39(0x115)]=_0x381a39(0xde),_0x22bb98(_0x3fffe1);}},'formatDeprecatedAssigmentsRequest':async(_0xee44fb,_0x7047a3,_0x78ca9b)=>{const _0x1fc89f=_0x1622fb,{user:_0x41f149,path:_0x44cefd}=_0xee44fb;try{switch(_0x44cefd){case'/myAssignments':_0xee44fb['body'][_0x1fc89f(0xd3)]=[_0x1fc89f(0xd1),_0x1fc89f(0x10d)];break;case'/lifecycleActivities':_0xee44fb['params']['relationshipName']=_0x1fc89f(0xe2);break;default:break;}return _0xee44fb[_0x1fc89f(0xd2)][_0x1fc89f(0x106)]=_0x1fc89f(0xdd),_0xee44fb['node']=_0x41f149,_0xee44fb[_0x1fc89f(0xd7)]=[],_0x78ca9b();}catch(_0x38f9cf){_0x38f9cf[_0x1fc89f(0x115)]=_0x1fc89f(0xde),_0x78ca9b(_0x38f9cf);}},'formatDeprecatedAccessRequest':async(_0x155628,_0x31960d,_0x112f19)=>{const _0x2dcde9=_0x1622fb,{method:_0xb9c164,path:_0x4e0c98,user:_0x4a4fe9}=_0x155628,{permissionSetName:_0x1511b3,memberId:_0x2a4d84}=_0x155628[_0x2dcde9(0xd2)],{permission:_0x5c5edd,members:members={},role:_0xc49f4a,canCreate:_0x211ea9}=_0x155628[_0x2dcde9(0xfe)];try{const _0x2a5245=_0xb9c164===_0x2dcde9(0xea),_0x42e799=_0xb9c164===_0x2dcde9(0x10e)||_0xb9c164===_0x2dcde9(0xe6),_0x3b2c7a=_0x4e0c98[_0x2dcde9(0xeb)](_0x2dcde9(0xd4))?_0x2dcde9(0xe4):'',_0x316516=_0x4e0c98['includes'](_0x2dcde9(0xfd))?_0x2dcde9(0xdd):'';if(_0x2a5245&&_0x5c5edd)return _0x155628[_0x2dcde9(0xfe)][_0x2dcde9(0x109)]={'name':_0x5c5edd},_0x155628[_0x2dcde9(0xd2)][_0x2dcde9(0x106)]='PermissionSet',_0x112f19();if(_0x5c5edd||_0x1511b3){const _0x2eb616={'_type':_0x2dcde9(0xe8),'_id':_0x5c5edd||_0x1511b3,'properties':{'name':_0x5c5edd||_0x1511b3},'user':_0x4a4fe9},_0x23c6c3=await DataService[_0x2dcde9(0xf5)](_0x2eb616),_0x11ed68=_0x23c6c3[_0x2dcde9(0x116)];_0x155628[_0x2dcde9(0xfe)][_0x2dcde9(0x102)]=_0x11ed68;}let _0xb65ed3;if((_0x2a5245||_0x42e799)&&_0x1511b3){const {action:_0x244658,type:_0xebaf13,_id:_0x4512a4,name:_0x330c66}=members;_0x155628[_0x2dcde9(0xed)]=_0x244658;const _0x17ec4c=_0xebaf13||_0x3b2c7a||_0x316516,_0x48d7d7=_0x4512a4||_0x2a4d84,_0x575cdf=await DataService[_0x2dcde9(0x105)](_0x17ec4c,{'user':_0x4a4fe9});_0xb65ed3=_0x575cdf[_0x2dcde9(0x116)][_0x2dcde9(0xf5)](_0x174d93=>{const _0x2da3b8=_0x2dcde9,_0x1c5430=_0x174d93['_id']===_0x48d7d7,_0x24c1ee=_0x174d93['properties'][_0x2da3b8(0x104)]&&_0x174d93[_0x2da3b8(0x109)][_0x2da3b8(0x104)]===_0x330c66;return _0x1c5430||_0x24c1ee;});if(!_0xb65ed3)throw ganisterError('\x27'+_0x17ec4c+_0x2dcde9(0xdf)+_0x48d7d7+_0x2dcde9(0x110),0x194);}else{if(_0x1511b3){const _0x215bd8=await DataService[_0x2dcde9(0x105)]('PermissionSet',{'user':_0x4a4fe9});_0xb65ed3=_0x215bd8[_0x2dcde9(0x116)][_0x2dcde9(0xf5)](_0x2e1c0a=>_0x2e1c0a[_0x2dcde9(0x109)]['name']===_0x1511b3);if(!_0xb65ed3)throw ganisterError(_0x2dcde9(0xf1)+_0x1511b3+_0x2dcde9(0x110),0x194);}else{const _0x4ba574=await DataService[_0x2dcde9(0x105)](_0x2dcde9(0xe4),{'user':_0x4a4fe9});_0xb65ed3=_0x4ba574[_0x2dcde9(0x116)][_0x2dcde9(0xf5)](_0x2865b5=>_0x2865b5[_0x2dcde9(0x109)][_0x2dcde9(0x104)]===_0x2dcde9(0x101));if(!_0xb65ed3)throw ganisterError('Group\x20\x27Administrator\x27\x20not\x20found',0x194);}}_0x155628[_0x2dcde9(0xd2)][_0x2dcde9(0x106)]=_0xb65ed3['_type'],_0x155628['params'][_0x2dcde9(0x111)]=_0xb65ed3[_0x2dcde9(0xf6)],_0x155628['body'][_0x2dcde9(0x109)]={'role':_0xc49f4a||_0x2dcde9(0x118),'canCreate':_0x211ea9||![]},_0x155628[_0x2dcde9(0xd2)][_0x2dcde9(0xda)]='accessRole';if(!_0x2a5245&&_0x1511b3){const _0x2ea1be=await DataService['all'](_0x2dcde9(0xe5),{'node':_0xb65ed3,'user':_0x4a4fe9}),_0x5759e8=_0x2ea1be['data']['find'](_0x134ffd=>{const _0x5cd41d=_0x2dcde9,_0x43c069=_0x2a4d84?_0x134ffd['source'][_0x5cd41d(0xf6)]===_0x2a4d84:_0x134ffd[_0x5cd41d(0xd0)][_0x5cd41d(0xf6)]===_0xb65ed3[_0x5cd41d(0xf6)],_0x3723e8=_0x134ffd[_0x5cd41d(0x102)][_0x5cd41d(0x10c)]===_0x5cd41d(0xe8),_0x2cb13c=_0x134ffd[_0x5cd41d(0x102)]['properties'][_0x5cd41d(0x104)]===_0x1511b3;return _0x43c069&&_0x3723e8&&_0x2cb13c;});_0x5759e8&&(_0x5759e8[_0x2dcde9(0xdd)](_0x4a4fe9),_0x155628[_0x2dcde9(0xd2)][_0x2dcde9(0xd5)]=_0x5759e8['_id'],_0x155628[_0x2dcde9(0x114)]=_0x5759e8);}return _0x112f19();}catch(_0x21984f){_0x21984f[_0x2dcde9(0x115)]='Node\x20Error',_0x112f19(_0x21984f);}}};