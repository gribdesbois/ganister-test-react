const _0x58f297=_0x3b64;(function(_0x13fa14,_0x3f12a5){const _0x5a8c9e=_0x3b64,_0x19037d=_0x13fa14();while(!![]){try{const _0x55d2db=parseInt(_0x5a8c9e(0xbe))/0x1+-parseInt(_0x5a8c9e(0xc5))/0x2+parseInt(_0x5a8c9e(0xb9))/0x3+parseInt(_0x5a8c9e(0xb0))/0x4*(parseInt(_0x5a8c9e(0xc6))/0x5)+parseInt(_0x5a8c9e(0xc3))/0x6*(parseInt(_0x5a8c9e(0xc4))/0x7)+parseInt(_0x5a8c9e(0xb3))/0x8*(parseInt(_0x5a8c9e(0xbb))/0x9)+-parseInt(_0x5a8c9e(0xbf))/0xa;if(_0x55d2db===_0x3f12a5)break;else _0x19037d['push'](_0x19037d['shift']());}catch(_0x180e04){_0x19037d['push'](_0x19037d['shift']());}}}(_0x3ced,0x85d79));const {getRequiredRoles,addAccesses,addPermissionSetAccess}=require('../utils/accesses'),{ganisterError}=require(_0x58f297(0xb4)),{logAndRespond}=require(_0x58f297(0xb2));module[_0x58f297(0xba)]={'getUserAccess':async(_0x3529bb,_0x3e349e,_0x31420c)=>{const _0x8448c=_0x58f297,{user:_0x298c36}=_0x3529bb;let {node:_0x21eb2c}=_0x3529bb;const {nodetype:_0x176a16,nodeId:_0xb3de8e}=_0x3529bb[_0x8448c(0xc1)],{target:_0x1b7de8}=_0x3529bb[_0x8448c(0xb5)];try{if(!_0xb3de8e)await addPermissionSetAccess(_0x176a16,_0x298c36);else{if(!_0x21eb2c)_0x21eb2c={'_type':_0x176a16,'_id':_0xb3de8e};const _0x215564=getRequiredRoles(_0x3529bb);await addAccesses(_0x21eb2c,_0x298c36,_0x215564);const _0x5112bf=!!_0x298c36[_0x8448c(0xb7)][_0x8448c(0xc2)],_0x1c0555=_0x1b7de8?.[_0x8448c(0xbc)]===_0x8448c(0xaf);_0x1b7de8&&!_0x1c0555&&!_0x5112bf&&await addAccesses(_0x1b7de8,_0x298c36,_0x215564);}_0x31420c();}catch(_0x53d990){return logAndRespond(_0x3e349e,_0x53d990,__(_0x8448c(0xb6)));}},'requireAdmin':(_0x4d6cc4,_0x89822f,_0x48788f)=>{const _0x15a28c=_0x58f297,{user:_0x4ed033,method:_0x534fb8}=_0x4d6cc4,{nodetype:_0x15269d,nodeId:_0x560b67}=_0x4d6cc4[_0x15a28c(0xc1)];try{const {active:_0x291341,_isAdmin:_0x2a10b3}=_0x4ed033[_0x15a28c(0xb7)],_0x4d9ea7=_0x4ed033[_0x15a28c(0xc0)]===_0x560b67;if(_0x534fb8===_0x15a28c(0xb8)){if(_0x291341&&(_0x2a10b3||_0x4d9ea7))return _0x48788f();}if(_0x291341&&_0x2a10b3)return _0x48788f();const _0x3b3d28=_0x560b67?_0x15a28c(0xbd):'\x27'+_0x15269d+_0x15a28c(0xb1);throw ganisterError(__('ðŸš«\x20You\x20do\x20not\x20have\x20access\x20to\x20%s',_0x3b3d28),0x193);}catch(_0x4a0bcb){return logAndRespond(_0x89822f,_0x4a0bcb,__('Cannot\x20Access\x20Node'));}}};function _0x3b64(_0x19b6e4,_0x4cb7c4){const _0x3ced54=_0x3ced();return _0x3b64=function(_0x3b6406,_0x27faf1){_0x3b6406=_0x3b6406-0xaf;let _0x196b98=_0x3ced54[_0x3b6406];return _0x196b98;},_0x3b64(_0x19b6e4,_0x4cb7c4);}function _0x3ced(){const _0x29c836=['params','_isAdmin','6hwBUvS','1887613DHPeeU','122540aTHczs','5305IFITbl','PermissionSet','3564bnmwAN','\x27\x20nodes','../helpers/controllerHelpers','4335944hVqTWd','../utils/errors','body','Cannot\x20Access\x20Node','properties','PATCH','1297233bfWzgR','exports','18KKJlUC','_type','this\x20node','959849rPwfEw','30817690hxCUme','_id'];_0x3ced=function(){return _0x29c836;};return _0x3ced();}