const _0x3ca4bb=_0x325b;(function(_0x41bd80,_0x2790ef){const _0x2040ba=_0x325b,_0x30a578=_0x41bd80();while(!![]){try{const _0x29337c=parseInt(_0x2040ba(0x9e))/0x1*(parseInt(_0x2040ba(0xa8))/0x2)+parseInt(_0x2040ba(0x8a))/0x3+-parseInt(_0x2040ba(0x77))/0x4+-parseInt(_0x2040ba(0xa9))/0x5+-parseInt(_0x2040ba(0xa5))/0x6*(-parseInt(_0x2040ba(0x7c))/0x7)+-parseInt(_0x2040ba(0x92))/0x8+parseInt(_0x2040ba(0x86))/0x9;if(_0x29337c===_0x2790ef)break;else _0x30a578['push'](_0x30a578['shift']());}catch(_0x5990b4){_0x30a578['push'](_0x30a578['shift']());}}}(_0x5969,0x21dbc));const {ganisterError}=require(_0x3ca4bb(0xa1)),{logAndRespond}=require('../helpers/controllerHelpers'),{getNodetype}=require(_0x3ca4bb(0x80)),DataService=require(_0x3ca4bb(0x91));module[_0x3ca4bb(0xa6)]={'setRelationshipName':(_0x13de9f,_0x5043a8,_0x27efe5)=>{const _0x201e12=_0x3ca4bb,{url:_0x1556ea}=_0x13de9f;try{const _0xfb225d=_0x1556ea['split']('/'),_0xedcbf7=_0xfb225d[_0x201e12(0x9b)](_0xa684be=>{const _0x4c730b=_0x201e12,_0x13e247=_0xa684be[_0x4c730b(0x81)](),_0x37ef1c=_0x13e247[_0x4c730b(0x9f)](_0x4c730b(0x78))||_0x13e247['includes'](_0x4c730b(0x9d)),_0x29464e=_0x13e247[_0x4c730b(0x9f)](_0x4c730b(0x9c));return _0x37ef1c||_0x29464e;}),_0x399d11=_0xedcbf7[_0x201e12(0x81)](),_0x258ee1=_0x399d11[_0x201e12(0x9f)](_0x201e12(0x9c))?_0x201e12(0x82):_0x201e12(0x93);_0x13de9f[_0x201e12(0x99)][_0x201e12(0xa2)]=_0x258ee1,_0x27efe5();}catch(_0x118432){return logAndRespond(_0x5043a8,_0x118432);}},'getRelationship':async(_0x1f9b93,_0x8a175e,_0xf514ab)=>{const _0x595c84=_0x3ca4bb,{user:_0x29198b}=_0x1f9b93,{relationshipName:_0x1225d3,relationshipId:_0x1019ab}=_0x1f9b93['params'];try{const _0x5d5eb2={'_type':_0x1225d3,'_id':_0x1019ab,'user':_0x29198b},{data:_0x6edd2d,errors:_0x5a06bd}=await DataService['find'](_0x5d5eb2);if(!_0x6edd2d)throw ganisterError(__('Relationship\x20%s\x20not\x20found',_0x1225d3));_0x1f9b93['relationship']=_0x6edd2d,_0x1f9b93['errors']=_0x5a06bd,_0xf514ab();}catch(_0x55f41b){return logAndRespond(_0x8a175e,_0x55f41b,__(_0x595c84(0x75)));}},'checkRelationshipCreationRestrictions':async(_0x1c908f,_0x3cd634,_0x2be86b)=>{const _0x4baee2=_0x3ca4bb,{node:_0x29c1a7,user:_0xa3760d}=_0x1c908f,{relationshipName:_0x2e5523}=_0x1c908f['params'],{target:_0x1a966f}=_0x1c908f[_0x4baee2(0x84)];try{if(_0x2e5523===_0x4baee2(0x79)){const {data:_0x2c6c6d}=await DataService['find'](_0x1a966f),{data:_0x2fcf60}=await DataService['all'](_0x4baee2(0x79),{'node':_0x2c6c6d,'user':_0xa3760d,'recursive':!![]});for(const _0x52292a of _0x2fcf60){if(_0x52292a[_0x4baee2(0xab)][_0x4baee2(0x9a)]===_0x29c1a7['_id'])throw ganisterError(__('Can\x27t\x20Create\x20Group\x20Loop'),0x199);}}_0x2be86b();}catch(_0x1c6447){return logAndRespond(_0x3cd634,_0x1c6447,__(_0x4baee2(0x8e)));}},'checkExistingRelationship':async(_0x58ecee,_0x157bf5,_0x2baa01)=>{const _0x5f1073=_0x3ca4bb,{node:_0x278919,user:_0x166411}=_0x58ecee,{relationshipName:_0x189380}=_0x58ecee[_0x5f1073(0x99)],{properties:properties={},target:target={}}=_0x58ecee[_0x5f1073(0x84)];try{const _0x358560=getNodetype(_0x189380),{cardinality:_0x43c22d,forbidDuplRels:_0x555de0}=_0x358560,_0x58bcc9=['accessRole',_0x5f1073(0x82)]['includes'](_0x189380),_0x4242d5=[_0x5f1073(0xa0),_0x5f1073(0x8b)][_0x5f1073(0x9f)](_0x43c22d);if(_0x58bcc9||_0x4242d5||_0x555de0){const {data:_0xd86af,errors:_0x851940}=await DataService[_0x5f1073(0x85)](_0x189380,{'node':_0x278919,'user':_0x166411}),_0x48e7de=_0xd86af,_0x567a0b=_0x48e7de[_0x5f1073(0xaa)](_0x50e193=>{const _0xbd02d=_0x5f1073,_0xbf1f77=_0x50e193[_0xbd02d(0x87)][_0xbd02d(0x9a)]===_0x278919['_id'];if(_0x58bcc9){const _0x4180e2=_0x50e193['target'][_0xbd02d(0x9a)]===target[_0xbd02d(0x9a)],_0x196d31=_0x50e193[_0xbd02d(0x7a)]['role']===properties[_0xbd02d(0x7f)];return _0xbf1f77&&_0x4180e2&&_0x196d31;}if(_0x555de0){const _0x252d05=_0x50e193['target'][_0xbd02d(0x9a)]===target[_0xbd02d(0x9a)];return _0xbf1f77&&_0x252d05;}const _0x8922ef=_0x50e193[_0xbd02d(0xab)]['_type']===target[_0xbd02d(0x7e)];return _0xbf1f77&&_0x8922ef;});if(_0x567a0b){if(_0x58bcc9||_0x555de0)throw ganisterError(__(_0x5f1073(0x83)));throw ganisterError(__(_0x5f1073(0xa4)+_0x189380+_0x5f1073(0x97)+_0x278919['_type']+_0x5f1073(0x94)+target['_type']+'\x27'));}_0x58ecee[_0x5f1073(0x8d)]=[..._0x58ecee[_0x5f1073(0x8d)],..._0x851940];}_0x2baa01();}catch(_0x2f0b1c){return logAndRespond(_0x157bf5,_0x2f0b1c,__(_0x5f1073(0xa3)));}},'checkSourceLockState':(_0x3f16bc,_0x725a94,_0x550b16)=>{const _0x5f180e=_0x3ca4bb,{user:_0xeab1cb,node:_0x18668b}=_0x3f16bc,{relationshipName:_0x506b6c}=_0x3f16bc[_0x5f180e(0x99)];try{const _0xf98f6c=[_0x5f180e(0x93),_0x5f180e(0x82),'groupMember'];if(_0xf98f6c[_0x5f180e(0x9f)](_0x506b6c))return _0x550b16();const {_lockable:_0x34bed0,_lockState:_0xb4c058,_lockedBy:_0xb16670}=_0x18668b[_0x5f180e(0x7a)],{_isAdmin:_0x59e54d}=_0xeab1cb[_0x5f180e(0x7a)];if(_0x59e54d)return _0x550b16();const _0x372dd6=_0xb4c058&&_0xb16670===_0xeab1cb[_0x5f180e(0x9a)],_0x45f83e=_0x34bed0&&(_0x372dd6||!_0xb4c058);if(!_0x45f83e)throw ganisterError('\x27'+_0x18668b[_0x5f180e(0x7e)]+'\x27\x20'+_0x18668b[_0x5f180e(0x7a)]?.['_labelRef']+_0x5f180e(0x90));_0x550b16();}catch(_0x2c9a6f){return logAndRespond(_0x725a94,_0x2c9a6f,_0x5f180e(0x95));}},'checkMinimumAccess':async(_0x50693c,_0x2d75fa,_0x20a61d)=>{const _0x42d1da=_0x3ca4bb,{relationship:_0x2c6e24,user:_0x4711e3,errors:_0x391efa}=_0x50693c,{relationshipName:_0x3b3e26,relationshipId:_0x204623}=_0x50693c[_0x42d1da(0x99)];try{if(_0x3b3e26!=='accessRole')return _0x20a61d();const {target:_0x4ed2f7}=_0x2c6e24,_0x140a59=await DataService[_0x42d1da(0x85)](_0x3b3e26,{'node':_0x4ed2f7,'user':_0x4711e3,'reverse':!![]}),_0x76803e=_0x140a59[_0x42d1da(0x8c)],_0x22a101=_0x76803e[_0x42d1da(0x9b)](_0x49b1d8=>{const _0x40131e=_0x42d1da,{role:_0x84e940,_id:_0x11fdde}=_0x49b1d8[_0x40131e(0x7a)];if(_0x11fdde===_0x204623)return;return _0x84e940===_0x40131e(0x8f)||_0x84e940===_0x40131e(0x7d);});if(!_0x22a101)throw ganisterError(__(_0x42d1da(0x7b)));_0x50693c[_0x42d1da(0x8d)]=[..._0x391efa,..._0x140a59[_0x42d1da(0x8d)]],_0x20a61d();}catch(_0x66b5ff){return logAndRespond(_0x2d75fa,_0x66b5ff,_0x42d1da(0x95));}},'findStateOwner':async(_0x5ae4ce,_0x1ac47a)=>{const _0x2f4cca=_0x3ca4bb,{relationships:_0x26ad14,errors:_0x44c5cb}=_0x5ae4ce;try{_0x26ad14[_0x2f4cca(0x96)](_0x1395b0=>{const _0x2a4bf9=_0x2f4cca,{role:_0x5d79e7}=_0x1395b0[_0x2a4bf9(0x7a)];if(!_0x5d79e7)return;const {source:_0x4eeb0b}=_0x1395b0,{lifecycle:_0x20af7f}=_0x4eeb0b[_0x2a4bf9(0x88)];if(!_0x20af7f)return;const {states:_0x1b169f,roles:_0x59ad55}=_0x20af7f,_0x35543e=_0x1b169f[_0x2a4bf9(0x9b)](_0x4eca21=>_0x4eca21['name']===_0x4eeb0b[_0x2a4bf9(0x7a)][_0x2a4bf9(0x89)]);if(!_0x35543e)return;const _0xf2dcd4=_0x59ad55[_0x2a4bf9(0x9b)](_0x1b3d5e=>_0x1b3d5e[_0x2a4bf9(0x98)]===_0x5d79e7);if(!_0xf2dcd4)return;const _0x30916b=_0x35543e?.[_0x2a4bf9(0x76)]===_0xf2dcd4['id'];_0x1395b0['target'][_0x2a4bf9(0x7a)]['stateOwner']=_0x30916b;});const _0x571b58={'data':_0x26ad14,'errors':_0x44c5cb};return _0x1ac47a[_0x2f4cca(0xa7)](0xc8)[_0x2f4cca(0x74)](_0x571b58);}catch(_0x434337){return logAndRespond(_0x1ac47a,_0x434337,_0x2f4cca(0x95));}}};function _0x325b(_0x1e72c0,_0x5f4922){const _0x59690b=_0x5969();return _0x325b=function(_0x325bbe,_0x5c7b5f){_0x325bbe=_0x325bbe-0x74;let _0x34b3f9=_0x59690b[_0x325bbe];return _0x34b3f9;},_0x325b(_0x1e72c0,_0x5f4922);}function _0x5969(){const _0x8e75ca=['accessrole','groupMember','properties','At\x20least\x20one\x20manager\x20or\x20PermissionSet\x20has\x20to\x20keep\x20access','7JvTzMc','permissionSet','_type','role','../helpers','toLowerCase','lifecycleRole','This\x20relationship\x20already\x20exists','body','all','2252169psXkxm','source','datamodel','_state','25020YxCGOZ','1to1','data','errors','Can\x27t\x20Create\x20Relationship','manager','\x20is\x20locked.','../modules/dataService','1017728NKoNjn','accessRole','\x27\x20and\x20a\x20\x27','Relationship\x20Error','forEach','\x27\x20relationship\x20already\x20exists\x20between\x20this\x20\x27','name','params','_id','find','lifecyclerole','permissions','1267rExKyH','includes','Nto1','../utils/errors','relationshipName','Can\x27t\x20Add\x20Node\x27s\x20Relationship','A\x20\x27','878142VTihDa','exports','status','118lSZAsD','903385vqZeFi','some','target','send','Can\x27t\x20Get\x20Relationship','owner','132456ZckuVi'];_0x5969=function(){return _0x8e75ca;};return _0x5969();}