function _0x4939(){const _0xda1a75=['emails','callbackURL','googleAuth','5EkMYQL','log','getTime','MATCH\x20(u:user\x20{\x20email:\x20$email,\x20password:\x20$md5password\x20})\x20RETURN\x20u','fromHeader','sub','143xNPJDB','passport','77609wrcPLt','../modules/database','email','3082203vFIHZv','token','Strategy','776PaHOvg','records','tokenExpiration','3482590LIEGni','./basics','clientID','HeaderAPIKeyStrategy','exp','run','passport-google-oauth','runQuery','find','502644gmIkPu','new','passport-local','get','auth\x20key\x20expired','Google\x20Email','passport-jwt','OAuth2Strategy','statusCode','clientSecret','2109616LXREjv','user','error','session','use','34tthYWy','x-api-key','properties','authorization','passport-headerapikey','224274gdBvMG','197139nEzPJX'];_0x4939=function(){return _0xda1a75;};return _0x4939();}const _0x302dcb=_0x2b4b;(function(_0x2b049e,_0x13d12a){const _0x3e1e85=_0x2b4b,_0x47e0ca=_0x2b049e();while(!![]){try{const _0x3414a0=-parseInt(_0x3e1e85(0x163))/0x1+-parseInt(_0x3e1e85(0x172))/0x2*(parseInt(_0x3e1e85(0x178))/0x3)+-parseInt(_0x3e1e85(0x16d))/0x4+parseInt(_0x3e1e85(0x149))/0x5*(-parseInt(_0x3e1e85(0x177))/0x6)+-parseInt(_0x3e1e85(0x151))/0x7*(parseInt(_0x3e1e85(0x157))/0x8)+-parseInt(_0x3e1e85(0x154))/0x9+parseInt(_0x3e1e85(0x15a))/0xa*(parseInt(_0x3e1e85(0x14f))/0xb);if(_0x3414a0===_0x13d12a)break;else _0x47e0ca['push'](_0x47e0ca['shift']());}catch(_0x1798a3){_0x47e0ca['push'](_0x47e0ca['shift']());}}}(_0x4939,0xe1cf1));const passport=require(_0x302dcb(0x150)),JwtStrategy=require(_0x302dcb(0x169))[_0x302dcb(0x156)],LocalStrategy=require(_0x302dcb(0x165))['Strategy'],GoogleStrategy=require(_0x302dcb(0x160))[_0x302dcb(0x16a)],APIKeyStrategy=require(_0x302dcb(0x176))[_0x302dcb(0x15d)],{ExtractJwt}=require(_0x302dcb(0x169)),md5=require('md5'),config=require('../../config/config'),basics=require(_0x302dcb(0x15b)),Database=require(_0x302dcb(0x152)),DataService=require('../modules/dataService'),driver=config['db'],checkUserLogin=async(_0x64ba62,_0x3a87a1,_0x4e06fd)=>{const _0x20bb31=_0x302dcb;try{const _0x284330=_0x20bb31(0x14c),_0x1d68de={'email':_0x64ba62,'md5password':md5(_0x3a87a1)},[_0x50e44b]=await Database[_0x20bb31(0x161)](_0x284330,_0x1d68de),_0x1e6410=_0x50e44b?.[_0x20bb31(0x166)]('u');if(!_0x1e6410)return _0x4e06fd(null);const _0x5ec5a0=await DataService[_0x20bb31(0x164)](_0x1e6410);_0x4e06fd(_0x5ec5a0);}catch(_0x1ae820){_0x1ae820[_0x20bb31(0x16b)]=0x191,_0x4e06fd(_0x1ae820);}},checkGoogleLogin=async _0x17762b=>{const _0x4e1232=_0x302dcb;console['log'](_0x4e1232(0x168)),console[_0x4e1232(0x14a)](_0x17762b);try{const _0x5503c9='MATCH\x20(u:user\x20{\x20email:\x20$email\x20})\x20RETURN\x20u',_0x2328e1=driver[_0x4e1232(0x170)](),_0x1c9b3f=await _0x2328e1[_0x4e1232(0x15f)](_0x5503c9,{'email':_0x17762b}),[_0x6b4944]=_0x1c9b3f[_0x4e1232(0x158)],_0x3b04ea=_0x6b4944?.[_0x4e1232(0x166)]('u');if(!_0x3b04ea)return{};const _0x2e5542=await DataService[_0x4e1232(0x164)](_0x3b04ea);return _0x2e5542&&_0x2e5542[_0x4e1232(0x174)]&&(_0x2e5542[_0x4e1232(0x174)][_0x4e1232(0x155)]=basics['signToken'](_0x2e5542),_0x2e5542[_0x4e1232(0x174)][_0x4e1232(0x159)]=config['JWT_EXPIRATION']),_0x2e5542;}catch(_0x45caaf){console[_0x4e1232(0x16f)](_0x45caaf),_0x45caaf[_0x4e1232(0x16f)]=!![];throw _0x45caaf;}};passport[_0x302dcb(0x171)](new JwtStrategy({'jwtFromRequest':ExtractJwt[_0x302dcb(0x14d)](_0x302dcb(0x175)),'secretOrKey':config['JWT_SECRET']},async(_0x611825,_0x2c9946)=>{const _0x529b69=_0x302dcb;try{const _0x514484=_0x611825[_0x529b69(0x14e)],{data:_0x9da1f6}=await DataService[_0x529b69(0x162)]({'_type':_0x529b69(0x16e),'_id':_0x514484});if(_0x611825[_0x529b69(0x15e)]<new Date()['getTime']())return _0x2c9946(null,![],{'message':_0x529b69(0x167)});const _0x36b5f6=(_0x611825[_0x529b69(0x15e)]-new Date()[_0x529b69(0x14b)]())/0x3e8;_0x2c9946(null,_0x9da1f6);}catch(_0x3cb611){_0x3cb611[_0x529b69(0x16b)]=0x191,_0x2c9946(_0x3cb611,![]);}})),passport[_0x302dcb(0x171)](new LocalStrategy({'usernameField':_0x302dcb(0x153)},async(_0x147a34,_0x2ae555,_0x1d98fc)=>{try{checkUserLogin(_0x147a34,_0x2ae555,_0x53c455=>{const _0x3cb347=_0x2b4b;if(!_0x53c455)return _0x1d98fc(null,![]);return _0x53c455&&_0x53c455['properties']&&(_0x53c455[_0x3cb347(0x174)][_0x3cb347(0x155)]=basics['signToken'](_0x53c455),_0x53c455[_0x3cb347(0x174)][_0x3cb347(0x159)]=config['JWT_EXPIRATION']),_0x1d98fc(null,_0x53c455);});}catch(_0x3fb319){_0x3fb319['statusCode']=0x191,_0x1d98fc(_0x3fb319,![]);}}));const {clientID,clientSecret,callbackURL}=config[_0x302dcb(0x148)];function _0x2b4b(_0x5b5054,_0x43897e){const _0x49394e=_0x4939();return _0x2b4b=function(_0x2b4baa,_0xe92520){_0x2b4baa=_0x2b4baa-0x148;let _0x284940=_0x49394e[_0x2b4baa];return _0x284940;},_0x2b4b(_0x5b5054,_0x43897e);}clientID&&clientSecret&&callbackURL&&passport[_0x302dcb(0x171)](new GoogleStrategy({'clientID':config[_0x302dcb(0x148)][_0x302dcb(0x15c)],'clientSecret':config[_0x302dcb(0x148)][_0x302dcb(0x16c)],'callbackURL':config['googleAuth'][_0x302dcb(0x17a)]},async(_0x5de7de,_0x5871ba,_0x3abc90,_0x16e081)=>{const _0x47f3b0=_0x302dcb,_0x5e8c30=await checkGoogleLogin(_0x3abc90[_0x47f3b0(0x179)][0x0]['value']);return _0x16e081(null,_0x5e8c30);}));passport[_0x302dcb(0x171)]('apikey',new APIKeyStrategy({'header':_0x302dcb(0x173)},![],async(_0x4c738f,_0x2ddff0)=>{const _0x5c14d9=_0x302dcb;try{const _0x7e0af9=md5(_0x4c738f),{data:_0x3ca730}=await DataService[_0x5c14d9(0x162)]({'_type':_0x5c14d9(0x16e),'apiKey':_0x7e0af9});_0x2ddff0(null,_0x3ca730);}catch(_0x585e15){_0x585e15[_0x5c14d9(0x16b)]=0x191,_0x2ddff0(_0x585e15,![]);}}));